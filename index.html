<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aarambha IT Club</title>
    
    <!-- Icons & Fonts -->
     <link rel="icon" type="image/png" href="itclub.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. MODERN PROFESSIONAL BLUE & WHITE THEME --- */
        :root {
            /* Palette: Shades of Blue & White */
            --primary: #0066cc;           /* Rich Blue */
            --primary-dark: #003d99;      /* Dark Blue */
            --primary-light: #3399ff;     /* Light Blue */
            --primary-soft: #e6f2ff;      /* Soft Blue bg */
            --primary-lighter: #f0f7ff;   /* Very Light Blue */
            
            --text-head: #001a4d;         /* Deep Blue */
            --text-body: #1a3a52;         /* Dark Blue-Grey */
            --text-muted: #5a7a8a;        /* Blue-Grey */
            
            /* Backgrounds */
            --bg-body: #f5f9ff;           /* Ultra light blue */
            --bg-card: #ffffff;           /* Pure white */
            
            /* Accents - Blue shades */
            --danger: #d63031;            /* Red-toned for contrast */
            --success: #00b894;           /* Teal-blue */
            --warning: #fdcb6e;           /* Light orange */
            
            /* Design Tokens */
            --radius-md: 12px;
            --radius-lg: 16px;
            --shadow-sm: 0 1px 3px rgba(0, 102, 204, 0.08);
            --shadow-md: 0 4px 6px -1px rgba(0, 102, 204, 0.12), 0 2px 4px -1px rgba(0, 102, 204, 0.08);
            --shadow-hover: 0 20px 25px -5px rgba(0, 102, 204, 0.15), 0 10px 10px -5px rgba(0, 102, 204, 0.1);
            --trans: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-font-smoothing: antialiased; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #e6f2ff 0%, #ffffff 50%, #f0f7ff 100%);
            color: var(--text-body);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5 { color: var(--text-head); font-weight: 700; letter-spacing: -0.025em; }
        a { text-decoration: none; color: inherit; cursor: pointer; }
        
        /* --- 2. GLASS HEADER WITH GRADIENT --- */
        header {
            background: linear-gradient(135deg, #0066cc 0%, #003d99 50%, #001a4d 100%);
            box-shadow: 0 4px 20px rgba(0, 102, 204, 0.2);
            height: 70px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.35rem;
            font-weight: 800;
            color: white;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .brand:hover {
            opacity: 1;
        }
        
        header:hover .brand {
            opacity: 1;
        }
        .brand img { height: 36px; width: 36px; object-fit: contain; border-radius: 8px; }

        .nav-links { display: flex; gap: 8px; }

        .nav-item {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.85);
            font-weight: 600;
            padding: 8px 16px;
            border-radius: var(--radius-md);
            transition: var(--trans);
            background: transparent;
            border: none;
            cursor: pointer;
        }
        .nav-item:hover { color: white; background: rgba(255, 255, 255, 0.15); }
        .nav-item.active { color: white; background: rgba(255, 255, 255, 0.25); }
        
        .btn-join-nav {
            background: rgba(255, 255, 255, 0.25);
            color: white !important;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        .btn-join-nav:hover { background: rgba(255, 255, 255, 0.35) !important; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); }

        /* Mobile Menu Toggle */
        .nav-mobile-toggle {
            display: none;
            align-items: center;
            gap: 8px;
            font-size: 1.3rem;
            color: white;
            cursor: pointer;
            background: none;
            border: none;
            padding: 12px 8px;
            min-width: 44px;
            min-height: 44px;
            justify-content: center;
            transition: var(--trans);
        }
        
        .nav-mobile-toggle:active {
            transform: scale(0.95);
        }
        
        .nav-mobile-menu {
            position: fixed;
            top: 70px;
            left: -100%;
            width: 100%;
            height: calc(100vh - 70px);
            background: linear-gradient(180deg, #ffffff 0%, #f5f9ff 100%);
            z-index: 999;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            box-shadow: -4px 4px 12px rgba(0, 102, 204, 0.15);
            backdrop-filter: blur(8px);
        }
        
        .nav-mobile-menu.active {
            left: 0;
            box-shadow: -4px 4px 16px rgba(0, 102, 204, 0.2);
        }
        
        .nav-mobile-menu .nav-item {
            display: block;
            width: 100%;
            text-align: left;
            padding: 16px 20px;
            border-radius: 0;
            border-bottom: 1px solid rgba(0, 102, 204, 0.08);
            color: #1a3a52 !important;
            background: transparent !important;
            min-height: 48px;
            display: flex;
            align-items: center;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        
        .nav-mobile-menu .nav-item:active {
            background: rgba(0, 102, 204, 0.08) !important;
        }
        
        .nav-mobile-menu .nav-item i {
            margin-right: 8px;
        }
        
        .nav-mobile-menu .btn-join-nav {
            margin: 16px;
            width: calc(100% - 32px);
            background: linear-gradient(135deg, #0066cc, #003d99) !important;
            color: white !important;
            border: none !important;
            min-height: 48px;
        }

        /* --- 3. HERO SECTION - MOBILE OPTIMIZED --- */
        .hero-section {
            position: relative;
            height: 500px;
            background: linear-gradient(135deg, #e6f2ff 0%, #f0f7ff 100%);
            overflow: hidden;
            margin: 0 0 40px 0;
            padding-top: 0;
            box-shadow: 0 4px 20px rgba(0, 102, 204, 0.15);
            width: 100vw;
            margin-left: calc(-50vw + 50%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.7;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, rgba(0, 102, 204, 0.05) 0%, rgba(0, 102, 204, 0.1) 100%);
        }

        .hero-logo {
            height: 100px;
            width: 100px;
            object-fit: cover;
            margin-bottom: 20px;
            border-radius: 50%;
            filter: drop-shadow(0 6px 16px rgba(0, 0, 0, 0.35));
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: white;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
            text-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        }

        .hero-subtitle {
            font-size: 1.1rem;
            color: white;
            font-weight: 500;
            margin: 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        /* --- 3b. LAYOUT --- */
        main {
            flex: 1;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px 40px 24px;
        }
        
        h1 { font-size: clamp(1.5rem, 5vw, 2.5rem); }
        h2 { font-size: clamp(1.3rem, 4vw, 2rem); }
        h3 { font-size: clamp(1.1rem, 3vw, 1.5rem); }

        .view-section { display: none; opacity: 0; transform: translateY(10px); transition: opacity 0.4s ease, transform 0.4s ease; }
        .view-section.active { display: block; opacity: 1; transform: translateY(0); }

        /* --- 4. MODERN CARDS - PREMIUM DESIGN --- */
        .card {
            background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
            border: 1px solid rgba(0, 102, 204, 0.12);
            border-radius: var(--radius-lg);
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.08);
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        /* Interactive Hover Effect for cards */
        .card-hover:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 24px rgba(0, 102, 204, 0.15);
            border-color: rgba(0, 102, 204, 0.25);
        }
        
        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(0, 102, 204, 0.1);
            background: linear-gradient(135deg, rgba(0, 102, 204, 0.02) 0%, rgba(255, 255, 255, 0) 100%);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title { 
            font-size: 1.1rem; 
            font-weight: 700; 
            margin: 0; 
            color: var(--text-head); 
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        
        .card-body { 
            padding: 24px;
        }

        .row { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; 
            margin-bottom: 24px; 
        }
        
        .col-full { grid-column: 1 / -1; }

        /* --- 5. UI COMPONENTS --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            font-size: 0.95rem;
            font-weight: 600;
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            transition: var(--trans);
            min-height: 44px;
            min-width: 44px;
        }
        .btn-primary { background: linear-gradient(135deg, #0066cc, #003d99); color: white; box-shadow: 0 4px 6px rgba(0, 102, 204, 0.25); }
        .btn-primary:hover { filter: brightness(110%); transform: translateY(-1px); box-shadow: 0 6px 12px rgba(0, 102, 204, 0.35); }
        .btn-danger { background: #d63031; color: white; }
        .btn-secondary { background: #e6f2ff; color: #1a3a52; }
        .btn-secondary:hover { background: #cce5ff; }
        .btn-outline { background: white; border: 1px solid rgba(0, 102, 204, 0.2); color: #1a3a52; }
        .btn-outline:hover { border-color: #0066cc; color: #0066cc; background: #f0f7ff; }
        .btn-sm { padding: 6px 12px; font-size: 0.85rem; border-radius: 8px; }

        .form-control {
            display: block;
            width: 100%;
            padding: 14px 16px;
            font-size: 1rem;
            color: var(--text-head);
            background-color: #ffffff;
            border: 2px solid rgba(0, 102, 204, 0.15);
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            transition: var(--trans);
            font-family: inherit;
            min-height: 44px;
        }
        .form-control:focus { border-color: #0066cc; box-shadow: 0 0 0 4px rgba(0, 102, 204, 0.15); background-color: #fafbff; }
        label { display: block; margin-bottom: 8px; font-size: 0.9rem; font-weight: 600; color: var(--text-head); }

        /* --- 6. SPECIFIC SECTIONS --- */
        
        /* Dashboard Stats */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 100%); 
            padding: 20px 16px; 
            border-radius: var(--radius-lg); 
            border: 1px solid rgba(0, 102, 204, 0.12); 
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 102, 204, 0.05);
            transition: var(--trans);
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.1);
        }
        .stat-number { font-size: clamp(2rem, 5vw, 3rem); font-weight: 800; color: #0066cc; line-height: 1; margin-bottom: 6px; letter-spacing: -1px; }
        .stat-label { font-size: 0.8rem; color: #5a7a8a; text-transform: uppercase; font-weight: 700; letter-spacing: 0.3px; }

        /* List Items */
        .list-group-item {
            padding: 16px 0;
            border-bottom: 1px solid rgba(0, 102, 204, 0.1);
            display: flex; gap: 16px;
            align-items: flex-start;
        }
        .list-group-item:last-child { border-bottom: none; padding-bottom: 0; }
        .list-icon { 
            width: 40px; height: 40px; background: #e6f2ff; color: #0066cc; 
            display: flex; align-items: center; justify-content: center; border-radius: 10px;
            flex-shrink: 0;
        }

        /* Team Grid */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        .member-card {
            background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(0, 102, 204, 0.12);
            text-align: center;
            padding: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.08);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .member-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 28px rgba(0, 102, 204, 0.15);
            border-color: rgba(0, 102, 204, 0.2);
        }
        
        .member-card:active {
            transform: scale(0.98);
        }
        
        .member-card.leader {
            border-color: #fdcb6e;
            background: linear-gradient(180deg, #fffbf0 0%, #ffffff 100%);
        }
        
        .member-card.leader:hover {
            box-shadow: 0 12px 32px rgba(253, 203, 110, 0.25);
            border-color: #ffa502;
            background: linear-gradient(180deg, #fffcf5 0%, #ffffff 100%);
        }
        
        .member-img-container {
            height: 200px;
            width: 100%;
            background: linear-gradient(135deg, #e6f2ff 0%, #f0f7ff 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .member-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover;
            object-position: center 35%;
            transition: transform 0.6s ease-in-out;
            background: white;
        }
        
        .member-card:hover .member-img { 
            transform: scale(1.08); 
        }
        
        .member-card.leader .member-img-container {
            background: linear-gradient(135deg, #fff5e6 0%, #fffaf0 100%);
            border-bottom: 3px solid #fdcb6e;
        }
        
        .member-info { 
            padding: 20px; 
            position: relative;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        
        .member-card.leader .member-info {
            background: linear-gradient(180deg, rgba(253, 203, 110, 0.08) 0%, rgba(255, 255, 255, 0) 100%);
        }
        
        .member-role { 
            font-size: 0.75rem; 
            background: #e6f2ff; 
            color: #0066cc; 
            font-weight: 700; 
            text-transform: uppercase; 
            padding: 6px 14px; 
            border-radius: 20px; 
            display: inline-block; 
            margin-bottom: 8px;
            border: 1px solid rgba(0, 102, 204, 0.2);
            align-self: flex-start;
        }
        
        .member-card.leader .member-role {
            background: #e6f2ff;
            color: #0066cc;
            border: 1px solid rgba(0, 102, 204, 0.2);
            font-weight: 700;
            box-shadow: none;
        }
        
        .member-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #fdcb6e, #ffa502);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            box-shadow: 0 4px 12px rgba(255, 165, 2, 0.4);
            border: 3px solid white;
            animation: float 3s ease-in-out infinite;
            z-index: 10;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .member-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 6px;
            color: var(--text-head);
            word-break: break-word;
        }
        
        .member-card.leader .member-name {
            font-size: 1.15rem;
            color: #000;
        }
        
        .member-position {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
            line-height: 1.3;
        }
        
        .filter-bar { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center; padding: 0 8px; }
        .filter-btn {
            background: white; border: 1px solid rgba(0, 102, 204, 0.2); padding: 8px 20px; border-radius: 30px; 
            cursor: pointer; font-size: 0.9rem; font-weight: 600; color: #5a7a8a; transition: var(--trans);
        }
        .filter-btn:hover, .filter-btn.active { background: #0066cc; color: white; border-color: #0066cc; }

        /* Rich Content Card */
        .rich-content-card {
            display: flex; 
            flex-direction: column; 
            height: 100%;
            border: 1px solid rgba(0, 102, 204, 0.12); 
            border-radius: var(--radius-lg); 
            overflow: hidden;
            background: white; 
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 102, 204, 0.08);
        }
        
        .rich-content-card:hover { 
            transform: translateY(-6px); 
            box-shadow: 0 12px 24px rgba(0, 102, 204, 0.15); 
            border-color: rgba(0, 102, 204, 0.2); 
        }
        
        .rich-img { 
            height: 200px; 
            background-size: cover; 
            background-position: center;
        }
        
        .rich-body { 
            padding: 24px; 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
        }
        
        .rich-tag { 
            font-size: 0.7rem; 
            font-weight: 700; 
            text-transform: uppercase; 
            letter-spacing: 0.5px;
            margin-bottom: 10px; 
            color: #0066cc;
        }

        /* --- 6.5 HIGHLIGHTS CARD ENHANCEMENT - ACHIEVEMENT STYLE --- */
        #homeRichContent {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
        }

        #homeRichContent .card {
            border: 1px solid #e0e0e0;
            border-radius: 14px;
            overflow: hidden;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            background: #ffffff;
        }

        #homeRichContent .card:hover {
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
            border-color: #c0c0c0;
            transform: translateY(-6px);
        }

        #homeRichContent .card-header {
            background: linear-gradient(135deg, #f5f5f5 0%, #fafafa 100%);
            border-bottom: 1px solid #e0e0e0;
            padding: 14px 18px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
        }

        #homeRichContent .card-title {
            font-size: 1.05rem;
            font-weight: 600;
            color: #1a1a1a;
            margin: 0;
            line-height: 1.3;
            flex: 1;
        }

        #homeRichContent .card-body {
            background: #ffffff;
            padding: 0;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        #homeRichContent .post-images-grid {
            width: 100%;
            margin: 0;
        }

        #homeRichContent .post-image-container {
            border-radius: 0;
            overflow: hidden;
            box-shadow: none;
            border: none;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #homeRichContent .post-image-container:first-child {
            border-radius: 0;
        }

        #homeRichContent .post-image {
            width: 100%;
            height: auto;
            object-fit: cover;
            background: #f5f5f5;
            display: block;
            min-height: 220px;
        }

        #homeRichContent .post-image-container:hover .post-image {
            transform: scale(1.03);
        }

        #homeRichContent .post-content {
            background: transparent;
            border-radius: 0;
            flex: 1;
            padding: 18px;
        }

        #homeRichContent .post-content p {
            color: #555555;
            margin: 0 0 12px 0;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        #homeRichContent .post-content p:last-child {
            margin-bottom: 0;
        }

        #homeRichContent .post-content a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid transparent;
        }

        #homeRichContent .post-content a:hover {
            color: #003d99;
            border-bottom: 1px solid #003d99;
        }

        #homeRichContent .post-content a:active {
            color: #001a4d;
        }

        #homeRichContent .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #fff9e6 0%, #fff5cc 100%);
            color: #8b7000;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 6px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            border: 1px solid rgba(139, 112, 0, 0.25);
            white-space: nowrap;
        }

        #homeRichContent .photo-count {
            font-size: 0.8rem;
            color: #0066cc;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #f0f0f0;
        }

        /* --- 6.6 RICH POST CONTENT FORMATTING --- */
        .post-content {
            line-height: 1.8;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .post-content p {
            margin-bottom: 16px;
            color: var(--text-body);
            line-height: 1.8;
            text-align: justify;
        }

        .post-content a {
            color: #0066cc;
            text-decoration: underline;
            transition: var(--trans);
            font-weight: 600;
            cursor: pointer;
        }

        .post-content a:hover {
            color: #003d99;
            text-decoration: underline;
            text-shadow: 0 0 10px rgba(0, 102, 204, 0.3);
        }

        .post-content a:active {
            color: #001a4d;
        }

        .post-images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }

        .post-image-container {
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: var(--trans);
            background: #f5f9ff;
            position: relative;
        }

        .post-image-container:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .post-image {
            width: 100%;
            height: auto;
            display: block;
            object-fit: contain;
            background: white;
            padding: 8px;
            border-radius: calc(var(--radius-md) - 4px);
        }

        /* --- 7. JOIN/CONTACT APPS SIDEBAR --- */
        .join-apps-sidebar {
            width: 320px;
            display: none; /* Hide contact us sidebar */
            flex-direction: column;
            gap: 0;
        }

        .apps-section {
            background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0, 102, 204, 0.08);
            border: 1px solid rgba(0, 102, 204, 0.1);
        }

        .app-card {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f8fbff 0%, #f0f7ff 100%);
            border-radius: 12px;
            border: 1px solid rgba(0, 102, 204, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .app-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 102, 204, 0.12);
            border-color: rgba(0, 102, 204, 0.2);
            background: linear-gradient(135deg, #ffffff 0%, #fafbff 100%);
        }

        .app-card:last-child {
            margin-bottom: 0;
        }

        .app-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .app-content {
            flex: 1;
        }

        .app-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: #001a4d;
            margin-bottom: 2px;
        }

        .app-subtitle {
            font-size: 0.75rem;
            color: #5a7a8a;
            font-weight: 500;
        }

        .app-card i:last-child {
            color: #0066cc;
            font-size: 1rem;
            opacity: 0;
            transition: all 0.3s ease;
            transform: translateX(-10px);
        }

        .app-card:hover i:last-child {
            opacity: 1;
            transform: translateX(0);
        }

        /* --- 7b. DASHBOARD APP CARDS - VERTICAL LAYOUT --- */
        .dashboard-apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .dashboard-app-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 20px;
            background: linear-gradient(135deg, #f8fbff 0%, #f0f7ff 100%);
            border-radius: 16px;
            border: 1px solid rgba(0, 102, 204, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .dashboard-app-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 24px rgba(0, 102, 204, 0.15);
            border-color: rgba(0, 102, 204, 0.2);
            background: linear-gradient(135deg, #ffffff 0%, #fafbff 100%);
        }

        .dashboard-app-icon {
            width: 60px;
            height: 60px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .dashboard-app-card:hover .dashboard-app-icon {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .dashboard-app-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .dashboard-app-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: #001a4d;
            margin: 0;
        }

        .dashboard-app-subtitle {
            font-size: 0.75rem;
            color: #5a7a8a;
            font-weight: 500;
            margin: 0;
        }

        /* --- 6.6 RICH POST CONTENT FORMATTING --- */

        /* Modal for full-size image view */
        .image-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.2s ease;
        }

        #newsContainer .post-content a {
            color: #0066cc;
            text-decoration: underline;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #newsContainer .post-content a:hover {
            color: #003d99;
            text-decoration: underline;
            text-shadow: 0 0 10px rgba(0, 102, 204, 0.3);
        }

        #newsContainer .post-content a:active {
            color: #001a4d;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .image-modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
        }

        .image-modal-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            max-width: 90vw;
            max-height: 90vh;
        }

        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--trans);
            backdrop-filter: blur(5px);
        }

        .image-modal-close:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.1);
        }

        /* Admin form enhancements */
        .multi-file-input-container {
            display: grid;
            gap: 12px;
            margin-bottom: 16px;
        }

        .file-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 12px;
            padding: 12px;
            background: var(--primary-soft);
            border-radius: var(--radius-md);
        }

        .file-preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1;
            background: white;
            border: 2px solid rgba(0, 102, 204, 0.2);
        }

        .file-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .file-preview-remove {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--danger);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            border-radius: 0 0 0 8px;
            transition: var(--trans);
        }

        .file-preview-remove:hover {
            background: #c92a2a;
        }

        .rich-text-tools {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 12px;
            padding: 12px;
            background: var(--primary-soft);
            border-radius: var(--radius-md);
            border: 1px solid rgba(0, 102, 204, 0.2);
        }

        .rich-text-tool-btn {
            padding: 8px 14px;
            border: 1px solid rgba(0, 102, 204, 0.3);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--primary);
            transition: var(--trans);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .rich-text-tool-btn:hover {
            background: white;
            border-color: var(--primary);
            color: var(--primary-dark);
            box-shadow: 0 2px 4px rgba(0, 102, 204, 0.15);
        }

        /* --- 7. ADMIN PANEL --- */
        .admin-container {
            display: grid;
            grid-template-columns: 240px 1fr;
            min-height: 700px;
            background: white;
            border: 1px solid rgba(0, 102, 204, 0.15);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }
        .admin-sidebar {
            background: linear-gradient(180deg, #f0f7ff 0%, #e6f2ff 100%);
            border-right: 1px solid rgba(0, 102, 204, 0.15);
            padding: 30px 16px;
        }
        .admin-content { padding: 40px; overflow-y: auto; max-height: 800px; }

        .sidebar-link {
            display: flex; align-items: center; gap: 12px;
            padding: 12px 16px;
            color: #5a7a8a;
            border-radius: var(--radius-md);
            cursor: pointer;
            margin-bottom: 4px;
            font-size: 0.95rem; font-weight: 500;
            transition: var(--trans);
        }
        .sidebar-link:hover { background: white; color: #003d99; box-shadow: var(--shadow-sm); }
        .sidebar-link.active { background: white; color: #0066cc; font-weight: 700; box-shadow: var(--shadow-sm); border-left: 3px solid #0066cc; }
        .sidebar-header {
            font-size: 0.75rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; margin: 24px 16px 10px;
        }

        table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 0.9rem; }
        th { text-align: left; padding: 16px; background: #f0f7ff; border-bottom: 1px solid rgba(0, 102, 204, 0.1); font-weight: 600; color: #0066cc; }
        td { padding: 16px; border-bottom: 1px solid rgba(0, 102, 204, 0.05); vertical-align: middle; }
        tr:last-child td { border-bottom: none; }

        /* Draggable Member Rows */
        tbody tr.member-row-draggable {
            cursor: grab; transition: background-color 0.2s ease, box-shadow 0.2s ease;
            position: relative;
        }
        tbody tr.member-row-draggable:active {
            cursor: grabbing;
        }
        tbody tr.member-row-draggable:hover {
            background: #f0f7ff; box-shadow: inset 0 0 0 1px rgba(0, 102, 204, 0.2);
        }
        tbody tr.member-row-draggable.dragging {
            opacity: 0.6; background: #e6f2ff; border-left: 4px solid #0066cc;
        }
        tbody tr.member-row-draggable.drag-over {
            background: linear-gradient(to bottom, rgba(0, 102, 204, 0.15), rgba(0, 102, 204, 0.08));
            border-top: 3px solid #0066cc;
            border-bottom: 3px solid #0066cc;
        }
        .member-row-drag-handle {
            cursor: grab; color: #0066cc; font-size: 1.2rem; user-select: none; margin-right: 8px;
            opacity: 0.7; transition: opacity 0.2s ease;
        }
        tbody tr.member-row-draggable:hover .member-row-drag-handle {
            opacity: 1;
        }
        .member-row-drag-handle:active {
            cursor: grabbing;
        }
        
        /* Banner Style */
        #siteBanner {
            background: linear-gradient(90deg, #003d99, #0066cc, #3399ff);
            color: white; text-align: center; padding: 10px 20px; font-weight: 600; font-size: 0.9rem;
            display: none; animation: slideDown 0.5s ease;
        }
        @keyframes slideDown { from { transform: translateY(-100%); } to { transform: translateY(0); } }

        /* Draggable Team Tags */
        .team-tag-draggable {
            background: #e6f2ff; padding: 8px 14px; border-radius: 20px; 
            font-size: 0.85rem; font-weight: 600; color: #0066cc;
            display: inline-flex; align-items: center; gap: 8px;
            cursor: move; user-select: none; transition: var(--trans); border: 1px solid transparent;
        }
        .team-tag-draggable:hover { background: white; border-color: #0066cc; box-shadow: var(--shadow-sm); }
        .team-tag-draggable.dragging { opacity: 0.5; border: 1px dashed #0066cc; }
        .tag-del-btn { cursor: pointer; color: #5a7a8a; transition: 0.2s; }
        .tag-del-btn:hover { color: #d63031; }

        /* Custom Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 102, 204, 0.3); z-index: 2000;
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(4px);
        }
        .modal-box {
            background: white; padding: 30px; border-radius: 16px;
            width: 90%; max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 102, 204, 0.2), 0 10px 10px -5px rgba(0, 102, 204, 0.1);
            animation: scaleIn 0.2s ease-out;
            border: 1px solid rgba(0, 102, 204, 0.1);
        }
        @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Utils */
        .hidden { display: none !important; }
        .text-muted { color: var(--text-muted); font-size: 0.9rem; line-height: 1.5; }
        .toast {
            position: fixed; bottom: 30px; right: 30px;
            background: linear-gradient(135deg, #003d99, #0066cc); color: white; padding: 16px 24px; border-radius: 12px;
            z-index: 9999; animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 15px -3px rgba(0, 102, 204, 0.3); font-weight: 500;
        }
        @keyframes slideIn { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* --- RESPONSIVE DESIGN --- */
        
        /* Tablet Devices (768px to 1024px) */
        @media (max-width: 1024px) {
            main { padding: 30px 16px; }
            .row { gap: 16px; }
            
            .dashboard-stats {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 16px;
            }
            .stat-number { font-size: 2.2rem; }
            
            .team-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
            
            .admin-container { grid-template-columns: 1fr; }
            .admin-sidebar { display: flex; overflow-x: auto; padding: 12px; border-bottom: 1px solid #e2e8f0; border-right: none; }
            .sidebar-link { white-space: nowrap; margin: 0 4px; padding: 10px 14px; font-size: 0.85rem; }
            .sidebar-header { display: none; }
            
            .header-container { padding: 0 16px; }
            .nav-links { display: none; }
            .brand { font-size: 1.15rem; }
        }
        
        /* Mobile Devices (480px to 768px) - COMPLETELY SEPARATE MOBILE DESIGN */
        @media (max-width: 768px) {
            :root {
                --radius-md: 12px;
                --radius-lg: 16px;
            }
            
            * { -webkit-tap-highlight-color: transparent; }
            
            body { 
                padding-top: 0; 
                background-color: #ffffff;
                margin: 0;
            }
            
            /* MOBILE HEADER */
            header { 
                height: 64px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                margin: 0;
                padding: 0;
            }
            
            .header-container { 
                height: 64px; 
                padding: 0 16px;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .brand { 
                font-size: 1.1rem; 
                gap: 10px;
                opacity: 1;
            }
            
            .brand img { 
                height: 36px; 
                width: 36px;
                border-radius: 8px;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
            }
            
            .brand span { display: none; }
            
            .nav-links { display: none; }
            
            .nav-mobile-toggle { 
                display: flex !important;
                font-size: 1.4rem;
                padding: 8px;
            }
            
            /* MOBILE MENU - NO ANIMATIONS */
            .nav-mobile-menu {
                position: fixed;
                top: 64px;
                left: 0;
                width: 100%;
                height: calc(100vh - 64px);
                background: #ffffff;
                z-index: 999;
                transition: none;
                overflow-y: auto;
                display: none;
            }
            
            .nav-mobile-menu.active {
                display: block;
            }
            
            .nav-mobile-menu .nav-item {
                display: block;
                width: 100%;
                text-align: left;
                padding: 16px 20px;
                border-bottom: 1px solid #f0f0f0;
                color: #1a3a52 !important;
                background: transparent !important;
                min-height: 48px;
                display: flex;
                align-items: center;
                font-weight: 500;
                border-radius: 0;
                font-size: 1rem;
            }
            
            .nav-mobile-menu .nav-item:active {
                background: #f5f5f5 !important;
            }
            
            .nav-mobile-menu .nav-item i {
                margin-right: 12px;
                color: #0066cc;
                font-size: 1.2rem;
            }
            
            .nav-mobile-menu .btn-join-nav {
                margin: 20px 16px;
                width: calc(100% - 32px);
                background: linear-gradient(135deg, #0066cc, #003d99) !important;
                color: white !important;
                border: none !important;
                min-height: 50px;
                border-radius: 12px;
                font-weight: 600;
                font-size: 1rem;
                box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
            }
            
            /* MOBILE MAIN CONTENT */
            main { 
                padding: 0;
                background: #ffffff;
            }
            
            /* HERO SECTION - TOUCHES TOP, NO GAPS */
            .hero-section {
                position: relative;
                height: 280px;
                background: linear-gradient(135deg, #0066cc 0%, #003d99 100%);
                overflow: hidden;
                margin: 0;
                padding: 0;
                width: 100vw;
                margin-left: calc(-50vw + 50%);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .hero-background {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-size: cover;
                background-position: center;
                opacity: 0.3;
            }

            .hero-content {
                position: relative;
                z-index: 2;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                text-align: center;
                padding: 20px;
                background: transparent;
            }

            .hero-logo {
                height: 80px;
                width: 80px;
                object-fit: cover;
                margin-bottom: 12px;
                border-radius: 50%;
                filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            }

            .hero-title {
                font-size: 1.6rem;
                font-weight: 800;
                color: white;
                margin: 0;
                margin-bottom: 8px;
                letter-spacing: -0.5px;
                text-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            }

            .hero-subtitle {
                font-size: 0.95rem;
                color: rgba(255, 255, 255, 0.95);
                font-weight: 400;
                margin: 0;
                text-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
            }
            
            /* MAIN CONTENT PADDING - AFTER HERO */
            main > div:not(.hero-section) {
                padding: 0 16px;
            }
            
            /* WELCOME SECTION */
            main > div[style*="text-align: center"] {
                padding: 24px 16px !important;
                margin: 0 !important;
            }
            
            main > div[style*="text-align: center"] h2 {
                font-size: 1.5rem;
                margin-bottom: 12px;
                color: #001a4d;
            }
            
            main > div[style*="text-align: center"] p {
                font-size: 0.95rem;
                color: #5a7a8a;
            }
            
            /* CARDS - SEPARATE MOBILE DESIGN */
            .row { 
                display: grid; 
                grid-template-columns: 1fr; 
                gap: 14px;
                margin-bottom: 20px;
                padding: 0 16px;
            }
            
            .col-full { grid-column: 1; }
            
            .card { 
                margin-bottom: 0;
                border-radius: 12px;
                border: 1px solid #e8f0ff;
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.06);
                overflow: hidden;
                background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
                transition: all 0.2s ease;
            }
            
            .card:active {
                box-shadow: 0 2px 6px rgba(0, 102, 204, 0.1);
            }
            
            .card-header { 
                padding: 16px 16px;
                background: #f8fbff;
                border-bottom: 1px solid #e8f0ff;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .card-title {
                font-size: 1.05rem;
                font-weight: 700;
                color: #001a4d;
                display: flex;
                align-items: center;
                gap: 10px;
                margin: 0;
            }
            
            .card-body { 
                padding: 16px;
                background: #ffffff;
            }
            
            h1 { 
                font-size: 1.6rem;
                line-height: 1.3;
                margin: 0 0 12px 0;
                color: #001a4d;
                font-weight: 700;
                padding: 0 16px;
            }
            
            h2 { 
                font-size: 1.4rem;
                line-height: 1.3;
                margin: 0 0 12px 0;
                color: #001a4d;
                font-weight: 700;
                padding: 0 16px;
            }
            
            h3 { 
                font-size: 1.15rem;
                line-height: 1.4;
                margin: 0 0 12px 0;
                color: #001a4d;
                font-weight: 700;
                padding: 0 16px;
            }
            
            /* BUTTONS */
            .btn {
                padding: 13px 18px;
                font-size: 0.95rem;
                border-radius: 10px;
                min-height: 46px;
                width: 100%;
                font-weight: 600;
                transition: all 0.2s ease;
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.08);
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }
            
            .btn:active {
                transform: translateY(1px);
                box-shadow: 0 1px 2px rgba(0, 102, 204, 0.05);
            }
            
            .btn-primary {
                background: linear-gradient(135deg, #0066cc, #003d99);
                color: white;
            }
            
            .btn-secondary {
                background: #e6f2ff;
                color: #1a3a52;
            }
            
            .btn-outline {
                background: white;
                border: 1px solid #e8f0ff !important;
                color: #1a3a52;
            }
            
            .btn-sm { 
                width: auto;
                min-height: auto;
                padding: 8px 14px;
            }
            
            /* FORMS */
            .form-control {
                display: block;
                width: 100%;
                padding: 12px 14px;
                font-size: 16px;
                color: #001a4d;
                background-color: #ffffff;
                border: 1px solid #e8f0ff;
                border-radius: 10px;
                margin-bottom: 16px;
                transition: all 0.2s ease;
                font-family: inherit;
                min-height: 46px;
                box-sizing: border-box;
            }
            
            .form-control:focus { 
                border-color: #0066cc;
                box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
                background-color: #fafbff;
            }
            
            label { 
                display: block; 
                margin-bottom: 6px; 
                font-size: 0.9rem; 
                font-weight: 600; 
                color: #001a4d;
            }
            
            textarea {
                font-size: 16px !important;
                padding: 12px 14px !important;
                border-radius: 10px !important;
                font-family: inherit;
            }
            
            /* DASHBOARD STATS */
            .dashboard-stats {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
                margin-bottom: 20px;
                padding: 0 16px;
            }
            
            .stat-card { 
                padding: 16px 12px; 
                border-radius: 10px; 
                border: 1px solid #e8f0ff; 
                text-align: center;
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.06);
                transition: all 0.2s ease;
                background: #ffffff;
            }
            
            .stat-card:active {
                transform: translateY(1px);
            }
            
            .stat-number { 
                font-size: 2rem; 
                font-weight: 800; 
                color: #0066cc; 
                line-height: 1; 
                margin-bottom: 4px; 
                letter-spacing: -1px; 
            }
            
            .stat-label { 
                font-size: 0.7rem; 
                color: #5a7a8a; 
                text-transform: uppercase; 
                font-weight: 700; 
                letter-spacing: 0.3px; 
            }
            
            /* TEAM GRID */
            .team-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                padding: 0 16px;
            }
            
            .member-card { 
                overflow: hidden; 
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.06);
                border: 1px solid #e8f0ff;
                border-radius: 10px;
                background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
                transition: all 0.2s ease;
                display: flex;
                flex-direction: column;
                padding: 0;
            }
            
            .member-card:active {
                box-shadow: 0 2px 6px rgba(0, 102, 204, 0.1);
            }
            
            .member-card.leader {
                background: #fffbf0;
                border-color: #ffe8b0;
            }
            
            .member-img-container { 
                height: 200px;
                width: 100%;
                background: linear-gradient(135deg, #e6f2ff 0%, #f0f7ff 100%);
                border-radius: 10px 10px 0 0;
            }
            
            .member-img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center 35%;
            }
            
            .member-info {
                padding: 12px;
                text-align: center;
                flex: 1;
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
            }
            
            .member-badge {
                position: absolute;
                top: 6px;
                right: 6px;
                background: linear-gradient(135deg, #fdcb6e, #ffa502);
                color: white;
                width: 28px;
                height: 28px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.95rem;
                box-shadow: 0 2px 6px rgba(255, 165, 2, 0.3);
                border: 2px solid white;
                z-index: 10;
            }
            
            .member-role { 
                font-size: 0.65rem; 
                background: #e6f2ff; 
                color: #0066cc; 
                font-weight: 700; 
                text-transform: uppercase; 
                padding: 4px 8px; 
                border-radius: 6px; 
                display: inline-block; 
                margin-bottom: 4px;
                border: 1px solid rgba(0, 102, 204, 0.2);
                width: fit-content;
            }
            
            .member-name {
                font-weight: 700;
                font-size: 0.95rem;
                margin-bottom: 2px;
                color: #001a4d;
            }
            
            .member-position {
                font-size: 0.8rem;
                color: #5a7a8a;
            }
            
            /* RICH CONTENT */
            .rich-content-card { 
                margin-bottom: 12px;
                border-radius: 10px;
                border: 1px solid #e8f0ff;
                overflow: hidden;
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.06);
                transition: all 0.2s ease;
                background: #ffffff;
            }
            
            .rich-content-card:active {
                box-shadow: 0 2px 6px rgba(0, 102, 204, 0.1);
            }
            
            .rich-img { 
                height: 140px;
            }
            
            .rich-body { 
                padding: 14px;
            }
            
            /* JOIN SECTION - MOBILE */
            #join {
                padding: 20px 0;
            }
            
            .join-apps-sidebar {
                display: none;
            }
            
            /* FILTER BAR */
            .filter-bar { 
                justify-content: flex-start; 
                overflow-x: auto;
                padding: 0 16px 12px 16px;
                gap: 8px;
                margin-bottom: 16px;
            }
            
            .filter-btn { 
                padding: 8px 14px;
                font-size: 0.85rem;
                min-width: max-content;
                flex-shrink: 0;
                border-radius: 10px;
                font-weight: 500;
                transition: all 0.2s ease;
                border: 1px solid #e8f0ff;
                background: white;
                color: #5a7a8a;
            }
            
            .filter-btn.active,
            .filter-btn:active {
                background: #0066cc;
                color: white;
                border-color: #0066cc;
            }
            
            /* SOCIAL MEDIA */
            #socialMediaDisplay {
                flex-direction: column;
                gap: 10px;
                padding: 0 !important;
            }
            
            #socialMediaDisplay a {
                padding: 14px 14px !important;
                width: 100%;
                min-width: auto;
                border-radius: 10px;
                font-weight: 600;
            }
            
            /* ADMIN */
            .admin-container { 
                border-radius: 10px;
                box-shadow: 0 1px 4px rgba(0, 102, 204, 0.06);
                margin: 0 16px;
            }
            
            .admin-sidebar { 
                border-radius: 10px 10px 0 0;
                padding: 8px;
                overflow-x: auto;
            }
            
            .admin-content { 
                padding: 18px;
            }
            
            .sidebar-link {
                padding: 11px 12px;
                font-size: 0.8rem;
                margin: 0 2px;
                border-radius: 8px;
                transition: all 0.2s ease;
            }
            
            .sidebar-header { display: none; }
            
            table { font-size: 0.85rem; }
            th, td { 
                padding: 11px 8px;
            }
            
            .modal-box { 
                width: 95%; 
                padding: 20px;
                border-radius: 12px;
            }
            
            .list-group-item { 
                padding: 12px 0; 
                gap: 12px;
            }
            
            .list-icon { 
                width: 38px; 
                height: 38px; 
                border-radius: 8px;
            }
            
            /* TOUCH FRIENDLY */
            button, a { 
                min-height: 46px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            input[type="checkbox"] { width: 20px !important; height: 20px !important; }
            select { 
                padding: 12px 12px !important;
                border-radius: 10px !important;
                font-size: 1rem !important;
                border: 1px solid #e8f0ff !important;
            }
            
            .team-tag-draggable { 
                padding: 8px 12px;
                font-size: 0.8rem;
                border-radius: 10px;
            }
            
            .text-muted { 
                font-size: 0.9rem;
                color: #5a7a8a;
            }
            
            #siteBanner { 
                padding: 10px 16px;
                font-size: 0.85rem;
            }
            
            .toast { 
                bottom: 20px; 
                right: 16px; 
                left: 16px;
                border-radius: 10px;
            }
            
            /* Hide admin from mobile */
            #nav-admin { display: none !important; }
            #nav-admin-m { display: none !important; }
            
            footer { 
                padding: 14px 12px !important;
                margin-top: 20px !important;
                background: linear-gradient(180deg, rgba(0, 102, 204, 0.05) 0%, rgba(0, 102, 204, 0.08) 100%) !important;
            }
            
            footer p {
                font-size: 10px !important;
                margin: 4px 0 !important;
            }
        }
        
        /* Small Mobile Devices (below 480px) - SIMPLIFIED DESIGN */
        @media (max-width: 480px) {
            header { 
                height: 60px;
                box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
            }
            
            .header-container { 
                height: 60px; 
                padding: 0 12px;
            }
            
            .brand { 
                font-size: 0.95rem; 
                gap: 8px;
            }
            
            .brand img { 
                height: 32px; 
                width: 32px;
            }
            
            .nav-mobile-toggle { 
                min-width: 44px; 
                min-height: 44px;
            }
            
            main { 
                padding: 0;
            }
            
            .hero-section { 
                height: 260px;
                margin-bottom: 0;
            }
            
            .hero-logo { 
                height: 70px; 
                width: 70px;
                margin-bottom: 10px;
            }
            
            .hero-title { 
                font-size: 1.4rem;
                margin-bottom: 6px;
            }
            
            .hero-subtitle { 
                font-size: 0.9rem;
            }
            
            main > div[style*="text-align: center"] {
                padding: 18px 12px !important;
            }
            
            main > div[style*="text-align: center"] h2 {
                font-size: 1.3rem;
                margin-bottom: 10px;
            }
            
            .row { 
                padding: 0 12px;
                gap: 12px;
                margin-bottom: 16px;
            }
            
            .dashboard-stats { 
                padding: 0 12px;
                gap: 10px;
                margin-bottom: 16px;
            }
            
            .stat-number { 
                font-size: 1.8rem;
            }
            
            .stat-label { 
                font-size: 0.65rem;
            }
            
            .card { 
                margin-bottom: 0;
                border-radius: 10px;
                background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
            }
            
            .card-header { 
                padding: 14px 14px;
                font-size: 0.95rem;
            }
            
            .card-body { 
                padding: 14px;
            }
            
            .card-title {
                font-size: 0.95rem;
            }
            
            h1 { 
                font-size: 1.4rem;
                padding: 0 12px;
            }
            
            h2 { 
                font-size: 1.25rem;
                padding: 0 12px;
            }
            
            h3 { 
                font-size: 1rem;
                padding: 0 12px;
            }
            
            .btn { 
                padding: 11px 16px; 
                font-size: 0.9rem;
                min-height: 44px;
                border-radius: 9px;
            }
            
            .btn-sm { 
                padding: 8px 12px; 
                font-size: 0.8rem;
                min-height: 40px;
            }
            
            .form-control { 
                padding: 11px 12px;
                margin-bottom: 14px;
                font-size: 16px;
                border-radius: 9px;
            }
            
            .rich-img { 
                height: 130px; 
            }
            
            .rich-body { 
                padding: 12px; 
            }
            
            .team-grid { 
                grid-template-columns: repeat(2, 1fr);
                padding: 0 12px;
                gap: 10px;
            }
            
            .member-card {
                border-radius: 10px;
                flex-direction: column;
            }
            
            .member-img-container { 
                height: 160px;
                width: 100%;
                border-radius: 10px 10px 0 0;
            }
            
            .member-info {
                padding: 8px 10px;
                text-align: center;
            }
            
            .member-name {
                font-size: 0.8rem;
                margin-bottom: 2px;
            }
            
            .member-role {
                font-size: 0.55rem;
                padding: 2px 5px;
                margin-bottom: 2px;
            }
            
            .member-position {
                font-size: 0.65rem;
            }
            
            .member-badge {
                width: 24px;
                height: 24px;
                font-size: 0.8rem;
            }
            
            .filter-bar { 
                padding: 0 12px 10px 12px;
                gap: 6px;
                margin-bottom: 12px;
            }
            
            .filter-btn { 
                padding: 7px 12px;
                font-size: 0.8rem;
                border-radius: 9px;
            }
            
            #socialMediaDisplay {
                gap: 8px;
            }
            
            #socialMediaDisplay a {
                padding: 12px 12px !important;
            }
            
            .admin-container { 
                border-radius: 10px;
                margin: 0 12px;
            }
            
            .admin-content { 
                padding: 14px;
            }
            
            table { font-size: 0.8rem; }
            th, td { 
                padding: 8px 6px;
            }
            
            .modal-box { 
                max-width: 100%;
                padding: 18px;
                border-radius: 12px;
            }
            
            .text-muted { 
                font-size: 0.85rem;
            }
            
            #siteBanner { 
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .list-icon { 
                width: 34px; 
                height: 34px;
            }
            
            /* JOIN SECTION - MOBILE RESPONSIVE */
            #join {
                padding: 0;
            }
            
            #join > div {
                display: block !important;
                flex-direction: column !important;
                gap: 0 !important;
            }
            
            #join > div > div:first-child {
                width: 100% !important;
                margin-bottom: 20px;
            }
            
            #join .card {
                margin: 0 16px;
            }
            
            .join-apps-sidebar {
                display: none !important;
            }
            
            .team-tag-draggable { 
                padding: 7px 10px;
                font-size: 0.75rem;
                border-radius: 8px;
            }
        }
        
        /* Ultra-small devices (below 380px) */
        @media (max-width: 380px) {
            header { 
                height: 56px;
            }
            
            .header-container { 
                height: 56px;
                padding: 0 10px;
            }
            
            .brand { 
                font-size: 0.85rem;
            }
            
            .brand img { 
                height: 28px; 
                width: 28px;
            }
            
            main { 
                padding: 0 !important;
            }
            
            .hero-section { 
                height: 240px;
            }
            
            .hero-logo { 
                height: 60px; 
                width: 60px;
                margin-bottom: 8px;
            }
            
            .hero-title { 
                font-size: 1.2rem;
                margin-bottom: 4px;
            }
            
            .hero-subtitle { 
                font-size: 0.85rem;
            }
            
            h1, h2, h3 { 
                font-size: 1.1rem;
                padding: 0 10px !important;
            }
            
            main > div[style*="text-align: center"] {
                padding: 14px 10px !important;
            }
            
            .row { 
                padding: 0 10px;
                gap: 10px;
                margin-bottom: 12px;
            }
            
            .card { 
                margin-bottom: 0;
                border-radius: 9px;
                background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 50%, #f8fbff 100%);
            }
            
            .card-header { 
                padding: 12px 12px;
            }
            
            .card-body { 
                padding: 12px;
            }
            
            .card-title {
                font-size: 0.9rem;
            }
            
            .btn { 
                padding: 10px 14px; 
                font-size: 0.85rem;
                border-radius: 8px;
            }
            
            .form-control { 
                padding: 10px 10px;
                margin-bottom: 12px;
                border-radius: 8px;
            }
            
            .dashboard-stats { 
                padding: 0 10px;
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .stat-number { 
                font-size: 1.6rem;
            }
            
            .team-grid { 
                grid-template-columns: repeat(2, 1fr);
                padding: 0 10px;
                gap: 8px;
            }
            
            .member-img-container { 
                height: 140px;
                width: 100%;
                border-radius: 8px 8px 0 0;
            }
            
            .member-info {
                padding: 8px 10px;
                text-align: center;
            }
            
            .member-name {
                font-size: 0.75rem;
            }
            
            .member-role {
                font-size: 0.5rem;
                padding: 2px 4px;
                margin-bottom: 2px;
            }
            
            .member-position {
                font-size: 0.6rem;
            }
            
            .filter-bar { 
                padding: 0 10px 8px 10px;
                gap: 5px;
            }
            
            .filter-btn { 
                padding: 6px 10px;
                font-size: 0.75rem;
                border-radius: 8px;
            }
        }
        
        /* Extra-small devices (320px) */
        @media (max-width: 320px) {
            header { 
                height: 54px;
            }
            
            .header-container { 
                height: 54px;
                padding: 0 8px;
            }
            
            .brand { 
                font-size: 0.8rem;
            }
            
            .brand img { 
                height: 26px; 
                width: 26px;
            }
            
            h1, h2, h3, h4 { 
                font-size: 1rem;
            }
            
            .hero-section { 
                height: 220px;
            }
            
            .hero-logo { 
                height: 50px; 
                width: 50px;
            }
            
            .hero-title { 
                font-size: 1rem;
            }
            
            .hero-subtitle { 
                font-size: 0.8rem;
            }
            
            .btn { 
                padding: 9px 12px; 
                font-size: 0.8rem;
                min-height: 40px;
            }
            
            .form-control { 
                padding: 9px 10px;
                font-size: 14px;
            }
            
            .row { 
                padding: 0 8px;
                gap: 8px;
            }
        }

        /* --- MODERN MOBILE ANIMATIONS - MINIMAL AND SMOOTH --- */
        @media (max-width: 768px) {
            /* Remove all complex animations, keep only simple ones */
            
            /* Smooth page transitions */
            .view-section {
                animation: fadeIn 0.3s ease-out;
            }
            
            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }
            
            /* Simple touch feedback */
            .card.card-hover:active,
            .stat-card:active,
            .member-card:active,
            .btn:active,
            .filter-btn:active {
                opacity: 0.9;
            }
            
            /* Smooth input focus */
            .form-control {
                transition: border-color 0.2s ease, box-shadow 0.2s ease;
            }
        }
    </style>
</head>
<body>

    <!-- GLOBAL BANNER -->
    <div id="siteBanner"></div>

    <!-- CUSTOM CONFIRM MODAL -->
    <div id="confirmModal" class="modal-overlay hidden">
        <div class="modal-box">
            <h3 id="confirmTitle" style="margin-bottom:10px; font-size:1.25rem;">Confirm Action</h3>
            <p id="confirmMsg" class="text-muted" style="margin-bottom:20px;">Are you sure?</p>
            <div style="display:flex; justify-content:flex-end; gap:10px;">
                <button class="btn btn-secondary" onclick="closeConfirm()">Cancel</button>
                <button class="btn btn-danger" id="confirmBtnYes">Yes, Delete</button>
            </div>
        </div>
    </div>

    <header>
        <div class="header-container">
            <div class="brand" onclick="router('home')">
                <img id="logoImg" src="https://via.placeholder.com/40" alt="Logo">
                <span>AARAMBHA IT CLUB</span>
            </div>
            <button class="nav-mobile-toggle" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="nav-links" id="navDesktop">
                <button class="nav-item active" id="nav-home" onclick="router('home')">Home</button>
                <button class="nav-item" id="nav-news" onclick="router('news')">News</button>
                <button class="nav-item" id="nav-team" onclick="router('team')">Team</button>
                <button class="nav-item" id="nav-ideas" onclick="router('ideas')">Ideas</button>
                <button class="nav-item btn-join-nav" id="nav-join" onclick="router('join')">Join Us</button>
                <button class="nav-item" id="nav-admin" onclick="router('admin')"><i class="fas fa-lock"></i> Admin</button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div class="nav-mobile-menu" id="navMobile">
            <button class="nav-item active" id="nav-home-m" onclick="router('home'); toggleMobileMenu()">Home</button>
            <button class="nav-item" id="nav-news-m" onclick="router('news'); toggleMobileMenu()">News</button>
            <button class="nav-item" id="nav-team-m" onclick="router('team'); toggleMobileMenu()">Team</button>
            <button class="nav-item" id="nav-ideas-m" onclick="router('ideas'); toggleMobileMenu()">Ideas</button>
            <button class="nav-item" id="nav-admin-m" onclick="router('admin'); toggleMobileMenu()"><i class="fas fa-lock"></i> Admin</button>
            <button class="nav-item btn-join-nav" id="nav-join-m" onclick="router('join'); toggleMobileMenu()">Join Us</button>
        </div>
    </header>

    <main>
        <div id="toastArea"></div>

        <!-- VIEW: HOME -->
        <section id="home" class="view-section active">
            <!-- HERO POSTER SECTION -->
            <div class="hero-section">
                <div class="hero-background" id="heroBackground"></div>
                <div class="hero-content">
                    <img id="heroLogo" class="hero-logo" src="https://via.placeholder.com/100" alt="Club Logo">
                    <h1 class="hero-title" id="heroTitle">Aarambha IT Club</h1>
                    <p class="hero-subtitle" id="heroSubtitle">Innovate. Create. Lead.</p>
                </div>
            </div>

            <div style="text-align: center; margin: 12px 0 40px; padding: 0;">
                <h2 style="font-size: clamp(1.8rem, 5vw, 2.5rem); color: var(--text-head); margin-bottom: 12px;">Welcome to Our Community</h2>
                <p class="text-muted" style="font-size: clamp(1rem, 3vw, 1.2rem); max-width: 600px; margin: 0 auto;">Shaping the future of technology, one student at a time.</p>
            </div>

            <div class="row">
                <!-- Targets -->
                <div class="card card-hover">
                    <div class="card-header"><span class="card-title"><i class="fas fa-bullseye" style="color:var(--danger)"></i> Key Targets</span></div>
                    <div class="card-body" id="homeTargets">Loading...</div>
                </div>
                <!-- Programs -->
                <div class="card card-hover">
                    <div class="card-header"><span class="card-title"><i class="fas fa-calendar-alt" style="color:var(--primary)"></i> Programs</span></div>
                    <div class="card-body" id="homePrograms">Loading...</div>
                </div>
                <!-- Meetings -->
                <div class="card card-hover">
                    <div class="card-header"><span class="card-title"><i class="fas fa-clock" style="color:var(--success)"></i> Meetings</span></div>
                    <div class="card-body" id="homeMeetings">Loading...</div>
                </div>
            </div>

            <!-- Blog/Achievements -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 16px; font-size: clamp(1.2rem, 4vw, 1.5rem);">Recent Highlights</h3>
                <div class="row" id="homeRichContent"></div>
            </div>

            <!-- Social Media Links -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 16px; font-size: clamp(1.2rem, 4vw, 1.5rem);">Connect With Us</h3>
                <div class="card">
                    <div class="card-body">
                        <div id="socialMediaDisplay" style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;"></div>
                        <p id="noSocialDisplay" class="text-muted" style="text-align: center;">Social media links will be displayed here.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW: NEWS -->
        <section id="news" class="view-section">
            <div style="max-width: 800px; margin: 0 auto;">
                <h2 style="margin-bottom: 30px; font-size: 2rem; text-align: center;">Latest Updates</h2>
                <div id="newsContainer">Loading...</div>
            </div>
        </section>

        <!-- VIEW: TEAM -->
        <section id="team" class="view-section">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2rem; margin-bottom: 16px;">Meet the Team</h2>
                <p class="text-muted" style="margin-bottom: 30px;">The dedicated individuals driving our vision forward.</p>
                <div id="teamFilters" class="filter-bar"></div>
            </div>
            <div id="teamGrid" class="team-grid"></div>
        </section>

        <!-- VIEW: IDEAS -->
        <section id="ideas" class="view-section">
            <div style="max-width: 600px; margin: 0 auto;">
                <div class="card" style="border-top: 4px solid var(--warning);">
                    <div class="card-header"><span class="card-title">Idea Box</span></div>
                    <div class="card-body">
                        <p class="text-muted" style="margin-bottom: 24px;">Got a spark? We value your creativity. Submit your suggestions anonymously and help us improve.</p>
                        <textarea id="ideaText" class="form-control" rows="5" placeholder="I think we should organize a..."></textarea>
                        <button class="btn btn-primary" id="btnSubmitIdea" style="width: 100%;">Send Suggestion</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW: JOIN -->
        <section id="join" class="view-section">
            <div style="display: flex; gap: 20px; max-width: 1000px; margin: 0 auto; padding: 0 20px;">
                <!-- Main Form -->
                <div style="flex: 1;">
                    <div class="card" style="border-top: 4px solid var(--primary);">
                        <div class="card-header"><span class="card-title">Membership Application</span></div>
                        <div class="card-body">
                            <p class="text-muted" style="margin-bottom: 20px;">Join a community of innovators. Fill out the details below to request membership.</p>
                            
                            <label>Full Name</label>
                            <input type="text" id="joinName" class="form-control" placeholder="Your full name">
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                <div>
                                    <label>Semester</label>
                                    <select id="joinSem" class="form-control" style="margin-bottom: 0;">
                                        <option>1st Sem</option><option>2nd Sem</option><option>3rd Sem</option><option>4th Sem</option>
                                        <option>5th Sem</option><option>6th Sem</option><option>7th Sem</option><option>8th Sem</option>
                                    </select>
                                </div>
                                <div>
                                    <label>Department</label>
                                    <select id="joinDept" class="form-control" style="margin-bottom: 0;">
                                        <option>BITM</option>
                                        <option>BHM</option>
                                    </select>
                                </div>
                            </div>

                            <label style="margin-top: 12px;">Interested Team</label>
                            <select id="joinTeam" class="form-control"></select>

                            <label>Why do you want to join?</label>
                            <textarea id="joinReason" class="form-control" rows="3" placeholder="Tell us about your interests..."></textarea>

                            <button class="btn btn-primary" id="btnJoinSubmit" style="width: 100%; padding: 14px;">Submit Application</button>
                        </div>
                    </div>
                </div>
                
                <!-- Apps Sidebar -->
                <div class="join-apps-sidebar">
                    <div class="apps-section">
                        <h4 style="margin: 0 0 16px 0; font-size: 0.95rem; font-weight: 700; color: #001a4d;">Get in Touch</h4>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">Email</div>
                                <div class="app-subtitle">Contact Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">Phone</div>
                                <div class="app-subtitle">Call Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <i class="fab fa-facebook"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">Facebook</div>
                                <div class="app-subtitle">Follow Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                                <i class="fab fa-instagram"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">Instagram</div>
                                <div class="app-subtitle">Follow Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #25D366, #128C7E);">
                                <i class="fab fa-whatsapp"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">WhatsApp</div>
                                <div class="app-subtitle">Chat With Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        
                        <div class="app-card">
                            <div class="app-icon" style="background: linear-gradient(135deg, #1DA1F2, #0E71C8);">
                                <i class="fab fa-twitter"></i>
                            </div>
                            <div class="app-content">
                                <div class="app-title">Twitter/X</div>
                                <div class="app-subtitle">Follow Us</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW: ADMIN -->
        <section id="admin" class="view-section">
            
            <!-- Login -->
            <div id="adminLogin" class="card" style="max-width: 400px; margin: 60px auto; padding: 10px; text-align: center; border-top: 4px solid var(--primary-dark);">
                <div class="card-body">
                    <h3 style="margin-bottom: 8px;">Admin Portal</h3>
                    <p class="text-muted" style="margin-bottom: 30px;">Restricted Access Area</p>
                    <input type="email" id="admEmail" class="form-control" placeholder="Email Address">
                    <input type="password" id="admPass" class="form-control" placeholder="Password">
                    <button id="btnLogin" class="btn btn-primary" style="width: 100%;">Secure Login</button>
                </div>
            </div>

            <!-- Panel -->
            <div id="adminPanel" class="hidden admin-container">
                <div class="admin-sidebar">
                    <div class="sidebar-header">Main</div>
                    <div class="sidebar-link active" onclick="admTab('dash', this)"><i class="fas fa-chart-pie" style="width:20px;"></i> Dashboard</div>
                    <div class="sidebar-link" onclick="admTab('inbox', this)"><i class="fas fa-inbox" style="width:20px;"></i> Inbox <span id="badgeInbox" style="margin-left:auto; background:var(--danger); color:white; font-size:10px; padding:2px 8px; border-radius:10px;" class="hidden">0</span></div>
                    
                    <div class="sidebar-header">Management</div>
                    <div class="sidebar-link" onclick="admTab('content', this)"><i class="fas fa-pen-nib" style="width:20px;"></i> Content</div>
                    <div class="sidebar-link" onclick="admTab('members', this)"><i class="fas fa-users" style="width:20px;"></i> Members</div>
                    
                    <div class="sidebar-header">Analytics</div>
                    <div class="sidebar-link" onclick="admTab('analytics', this)"><i class="fas fa-chart-bar" style="width:20px;"></i> Analytics</div>
                    <div class="sidebar-link" onclick="admTab('activity', this)"><i class="fas fa-history" style="width:20px;"></i> Recent Changes</div>
                    
                    <div class="sidebar-header">System</div>
                    <div class="sidebar-link" onclick="admTab('settings', this)"><i class="fas fa-sliders-h" style="width:20px;"></i> Settings</div>
                    <div class="sidebar-link" id="btnLogout" style="color: var(--danger); margin-top: 20px;"><i class="fas fa-sign-out-alt" style="width:20px;"></i> Logout</div>
                </div>

                <div class="admin-content">
                    
                    <!-- TAB: DASHBOARD -->
                    <div id="adm-dash" class="adm-view">
                        <h3 style="margin-bottom: 24px;">Overview</h3>
                        <div class="dashboard-stats">
                            <div class="stat-card">
                                <div class="stat-number" id="statMem">0</div>
                                <div class="stat-label">Total Members</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="statReq" style="color:var(--warning)">0</div>
                                <div class="stat-label">Pending Requests</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="statIdea" style="color:var(--success)">0</div>
                                <div class="stat-label">Idea Box</div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions Section -->
                        <div style="margin-top: 40px;">
                            <h3 style="margin-bottom: 20px;">Quick Actions</h3>
                            <div class="dashboard-apps-grid">
                                <div class="dashboard-app-card" onclick="admTab('inbox', document.querySelector('.sidebar-link[onclick*=inbox]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                        <i class="fas fa-inbox"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">View Requests</div>
                                        <div class="dashboard-app-subtitle">Join & Ideas</div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-app-card" onclick="admTab('members', document.querySelector('.sidebar-link[onclick*=members]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                        <i class="fas fa-users-cog"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">Manage Members</div>
                                        <div class="dashboard-app-subtitle">Approve & Remove</div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-app-card" onclick="admTab('content', document.querySelector('.sidebar-link[onclick*=content]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                        <i class="fas fa-pen-nib"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">Create Content</div>
                                        <div class="dashboard-app-subtitle">News & Team Posts</div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-app-card" onclick="admTab('settings', document.querySelector('.sidebar-link[onclick*=settings]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                                        <i class="fas fa-cog"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">Configure</div>
                                        <div class="dashboard-app-subtitle">Settings & Data</div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-app-card" onclick="admTab('activity', document.querySelector('.sidebar-link[onclick*=activity]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #25D366, #128C7E);">
                                        <i class="fas fa-history"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">Recent Changes</div>
                                        <div class="dashboard-app-subtitle">View Activity Log</div>
                                    </div>
                                </div>
                                
                                <div class="dashboard-app-card" onclick="admTab('analytics', document.querySelector('.sidebar-link[onclick*=analytics]'))" style="cursor: pointer;">
                                    <div class="dashboard-app-icon" style="background: linear-gradient(135deg, #1DA1F2, #0E71C8);">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <div class="dashboard-app-info">
                                        <div class="dashboard-app-title">Analytics</div>
                                        <div class="dashboard-app-subtitle">Visitor & Stats</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: INBOX -->
                    <div id="adm-inbox" class="adm-view hidden">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px;">
                             <h3>Inbox</h3>
                             <button class="btn btn-outline btn-sm" onclick="exportData('join_requests', 'join_requests.csv')"><i class="fas fa-download"></i> Export CSV</button>
                        </div>
                       
                        <div class="card">
                            <div class="card-header"><span class="card-title">Join Requests</span></div>
                            <div style="overflow-x: auto;">
                                <table id="tblRequests">
                                    <thead><tr><th>Name</th><th>Dept</th><th>Team</th><th>Action</th></tr></thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header"><span class="card-title">Idea Box</span></div>
                            <div style="overflow-x: auto;">
                                <table id="tblIdeas">
                                    <thead><tr><th>Suggestion</th><th>Date</th><th>Action</th></tr></thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: CONTENT -->
                    <div id="adm-content" class="adm-view hidden">
                        <h3 style="margin-bottom: 24px;">Content Manager</h3>
                        <div class="row">
                            <div class="card col-full">
                                <div class="card-header"><span class="card-title">Publish New Content</span></div>
                                <div class="card-body">
                                    <div style="display: grid; gap: 12px;">
                                        <div style="grid-column: 1 / -1;">
                                            <label>Content Type</label>
                                            <select id="pubType" class="form-control">
                                                <option value="posts">News / Minute</option>
                                                <option value="dashboard_target">Dashboard: Target</option>
                                                <option value="dashboard_program">Dashboard: Program</option>
                                                <option value="dashboard_meeting">Dashboard: Meeting</option>
                                                <option value="dashboard_blog">Blog Post</option>
                                                <option value="dashboard_achieve">Achievement</option>
                                            </select>
                                        </div>
                                        <div style="grid-column: 1 / -1;">
                                            <label>Title</label>
                                            <input id="pubTitle" class="form-control" placeholder="Enter headline...">
                                        </div>
                                        <div style="grid-column: 1 / -1;">
                                            <label>Content</label>
                                            <div class="rich-text-tools">
                                                <button class="rich-text-tool-btn" type="button" onclick="insertTextFormat('**')"><i class="fas fa-bold"></i> Bold</button>
                                                <button class="rich-text-tool-btn" type="button" onclick="insertTextFormat('_')"><i class="fas fa-italic"></i> Italic</button>
                                                <button class="rich-text-tool-btn" type="button" onclick="insertLink()"><i class="fas fa-link"></i> Link</button>
                                                <button class="rich-text-tool-btn" type="button" onclick="insertTextFormat('\n\n')"><i class="fas fa-paragraph"></i> Paragraph</button>
                                            </div>
                                            <textarea id="pubContent" class="form-control" rows="6" placeholder="Write your content here... Use line breaks for paragraphs. Format: **bold**, _italic_, and [link text](URL)"></textarea>
                                            <div style="font-size: 0.85rem; color: #5a7a8a; margin-top: 8px; line-height: 1.6;">
                                                <strong>Formatting Help:</strong>
                                                <div>**text** = bold | _text_ = italic | [link](url) = clickable link</div>
                                                <div>Separate paragraphs with blank lines for proper formatting</div>
                                            </div>
                                        </div>
                                        <div style="grid-column: 1 / -1;">
                                            <label>Images (Upload Multiple Photos)</label>
                                            <div class="multi-file-input-container">
                                                <input type="file" id="pubImg" class="form-control" multiple accept="image/*" style="padding: 9px; margin-bottom: 0;">
                                                <div id="imgPreview" class="file-preview-grid"></div>
                                            </div>
                                        </div>
                                        <div style="grid-column: 1 / -1;">
                                            <button id="btnPub" class="btn btn-primary" style="width: 100%;">Publish Now</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card col-full">
                                <div class="card-header"><span class="card-title">Live Content</span></div>
                                <div class="card-body" id="listContent" style="max-height: 600px; overflow-y: auto;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: MEMBERS -->
                    <div id="adm-members" class="adm-view hidden">
                        <div style="display:flex; flex-direction: column; gap:12px; margin-bottom:20px;">
                            <h3>Members</h3>
                            <div style="display:flex; flex-direction: column; gap:8px;">
                                <button class="btn btn-outline btn-sm" onclick="exportData('members', 'members_list.csv')" style="width: 100%;"><i class="fas fa-download"></i> Export CSV</button>
                                <button class="btn btn-primary btn-sm" onclick="openMemberForm()" style="width: 100%;"><i class="fas fa-plus"></i> Add Member</button>
                            </div>
                        </div>
                        
                        <!-- EDIT/ADD FORM -->
                        <div id="formAddMem" class="card hidden" style="border: 2px dashed var(--primary); background: var(--primary-soft); margin-bottom: 20px;">
                            <div class="card-body">
                                <h4 id="formMemTitle" style="margin-bottom:15px; color:var(--primary-dark);">Add New Member</h4>
                                <input type="hidden" id="memIdEdit"> <!-- Hidden ID for edits -->
                                
                                <div style="margin-bottom: 12px;">
                                    <input id="memName" class="form-control" placeholder="Name" style="margin-bottom: 12px;">
                                    <input id="memRole" class="form-control" placeholder="Role (e.g. President)">
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <select id="memTeam" class="form-control" style="margin-bottom: 12px;"></select>
                                    <div style="display:flex; align-items:center; gap:12px;">
                                        <input type="checkbox" id="memLeader" style="width: 20px; height: 20px;"> <label style="margin:0;">Is Team Leader</label>
                                    </div>
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <input type="file" id="memPhoto" class="form-control" style="padding:9px; margin-bottom: 0;">
                                </div>
                                <div style="display:flex; flex-direction: column; gap:10px;">
                                    <button id="btnAddMem" class="btn btn-primary" style="width: 100%;">Save Member</button>
                                    <button onclick="document.getElementById('formAddMem').classList.add('hidden')" class="btn btn-secondary" style="width: 100%;">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div style="overflow-x: auto;">
                                <table id="tblMembers">
                                    <thead><tr><th>Name</th><th>Role</th><th>Team</th><th>Leader</th><th>Actions</th></tr></thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: SETTINGS -->
                    <div id="adm-settings" class="adm-view hidden">
                        <h3 style="margin-bottom: 24px;">Settings</h3>
                        <div class="row">
                            <!-- TEAM MANAGER -->
                            <div class="card">
                                <div class="card-header"><span class="card-title">Team Structure Manager</span></div>
                                <div class="card-body">
                                    <p class="text-muted" style="margin-bottom:15px; font-size:0.85rem;">Drag to reorder. Deleting a team here does not delete its members.</p>
                                    
                                    <div style="display:flex; gap:12px; margin-bottom:20px;">
                                        <input id="newTeamType" class="form-control" style="margin:0;" placeholder="New Team Name (e.g. HR)">
                                        <button id="btnAddTeamType" class="btn btn-primary">Add</button>
                                    </div>
                                    
                                    <!-- Draggable List -->
                                    <div id="listTeamTypes" style="display:flex; gap:8px; flex-wrap:wrap; min-height:50px; border:1px dashed #e2e8f0; padding:10px; border-radius:12px;"></div>
                                </div>
                            </div>
                            
                            <!-- BRANDING & BANNER -->
                            <div class="card">
                                <div class="card-header"><span class="card-title">Club Branding & Alerts</span></div>
                                <div class="card-body">
                                    <label>Upload Logo</label>
                                    <div style="display:flex; flex-direction: column; gap:10px; margin-bottom:20px;">
                                        <input type="file" id="logoUpload" class="form-control" style="padding:9px; margin:0;">
                                        <button id="btnUpdateLogo" class="btn btn-primary" style="width: 100%;">Update</button>
                                    </div>

                                    <label style="border-top:1px solid #f1f5f9; padding-top:20px;">Top Banner Announcement</label>
                                    <input id="bannerText" class="form-control" placeholder="Announcement text...">
                                    <div style="display:flex; align-items:center; gap:12px; margin-bottom:15px;">
                                        <input type="checkbox" id="bannerActive" style="width:20px; height:20px;"> <label style="margin:0;">Show Banner</label>
                                    </div>
                                    <button id="btnSaveBanner" class="btn btn-primary" style="width:100%;">Save Banner Settings</button>
                                </div>
                            </div>

                            <!-- SOCIAL MEDIA LINKS -->
                            <div class="card">
                                <div class="card-header"><span class="card-title"><i class="fas fa-share-alt" style="margin-right:8px;"></i>Social Media Links</span></div>
                                <div class="card-body">
                                    <p class="text-muted" style="margin-bottom:20px; font-size:0.85rem;">Add or update social media platform links. These will be displayed on the dashboard.</p>
                                    
                                    <div id="socialMediaForm" style="background: var(--primary-soft); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                        <div style="display: grid; gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label>Platform</label>
                                                <select id="socialPlatform" class="form-control" style="margin-bottom: 0;">
                                                    <option value="Facebook">Facebook</option>
                                                    <option value="Twitter">Twitter / X</option>
                                                    <option value="Instagram">Instagram</option>
                                                    <option value="LinkedIn">LinkedIn</option>
                                                    <option value="YouTube">YouTube</option>
                                                    <option value="Discord">Discord</option>
                                                    <option value="GitHub">GitHub</option>
                                                    <option value="Telegram">Telegram</option>
                                                    <option value="TikTok">TikTok</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label>Profile URL</label>
                                                <input type="url" id="socialUrl" class="form-control" placeholder="https://..." style="margin-bottom: 0;">
                                            </div>
                                        </div>
                                        <button id="btnAddSocialMedia" class="btn btn-primary" style="width: 100%;">Add / Update Link</button>
                                    </div>

                                    <h5 style="margin-bottom: 15px; margin-top: 25px;">Current Links</h5>
                                    <div id="socialMediaList" style="display: flex; flex-direction: column; gap: 10px;"></div>
                                    <p id="noSocialMsg" class="text-muted" style="text-align: center; padding: 20px;">No social media links added yet.</p>
                                </div>
                            </div>

                            <!-- HERO POSTER MANAGER -->
                            <div class="card col-full">
                                <div class="card-header"><span class="card-title"><i class="fas fa-image" style="margin-right:8px;"></i>Hero Poster / Banner Manager</span></div>
                                <div class="card-body">
                                    <p class="text-muted" style="margin-bottom:20px; font-size:0.85rem;">Customize the hero section displayed on the home page. You can upload a background image and customize the text.</p>
                                    
                                    <div style="background: #f0f7ff; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                                        <div style="display: grid; gap: 16px; margin-bottom: 16px;">
                                            <div>
                                                <label>Hero Title</label>
                                                <input id="heroTitleInput" class="form-control" placeholder="e.g., Aarambha IT Club" style="margin-bottom: 0;">
                                            </div>
                                            <div>
                                                <label>Hero Subtitle</label>
                                                <input id="heroSubtitleInput" class="form-control" placeholder="e.g., Innovate. Create. Lead." style="margin-bottom: 0;">
                                            </div>
                                            <div>
                                                <label>Hero Logo / Image</label>
                                                <input type="file" id="heroLogoUpload" class="form-control" style="padding:9px; margin-bottom: 0;">
                                            </div>
                                            <div>
                                                <label>Background Image (Optional)</label>
                                                <input type="file" id="heroBgUpload" class="form-control" style="padding:9px; margin-bottom: 0;">
                                            </div>
                                        </div>
                                        <button id="btnSaveHero" class="btn btn-primary" style="width: 100%;">Save Hero Poster</button>
                                    </div>

                                    <h5 style="margin-bottom: 15px;">Preview</h5>
                                    <div class="hero-section" style="height: 250px;">
                                        <div class="hero-background" id="heroPreviewBg" style="opacity: 0.5;"></div>
                                        <div class="hero-content">
                                            <img id="heroPreviewLogo" class="hero-logo" src="https://via.placeholder.com/100" alt="Preview" style="height: 80px; width: 80px;">
                                            <h1 class="hero-title" id="heroPreviewTitle" style="font-size: 1.8rem;">Aarambha IT Club</h1>
                                            <p class="hero-subtitle" id="heroPreviewSubtitle">Innovate. Create. Lead.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: ANALYTICS -->
                    <div id="adm-analytics" class="adm-view hidden">
                        <h3 style="margin-bottom: 24px;">Website Analytics</h3>
                        
                        <!-- Live Visitors -->
                        <div class="card">
                            <div class="card-header"><span class="card-title"><i class="fas fa-globe" style="margin-right:8px;"></i>Live Visitors</span></div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 20px;">
                                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white; text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; margin-bottom: 8px;" id="liveVisitors">0</div>
                                        <div style="font-size: 0.9rem; opacity: 0.9;">Users Online Now</div>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 12px; color: white; text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; margin-bottom: 8px;" id="totalVisitors">0</div>
                                        <div style="font-size: 0.9rem; opacity: 0.9;">Total Visits (Today)</div>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 12px; color: white; text-align: center;">
                                        <div style="font-size: 2rem; font-weight: 700; margin-bottom: 8px;" id="uniqueVisitors">0</div>
                                        <div style="font-size: 0.9rem; opacity: 0.9;">Unique Visitors</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Device Analytics -->
                        <div class="card">
                            <div class="card-header"><span class="card-title"><i class="fas fa-devices" style="margin-right:8px;"></i>Device Breakdown</span></div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                                    <div style="background: #f0f7ff; padding: 16px; border-radius: 10px; border-left: 4px solid #0066cc;">
                                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;"><i class="fas fa-mobile-alt" style="margin-right: 6px;"></i>Mobile</div>
                                        <div style="font-size: 1.8rem; font-weight: 700; color: var(--text-head);" id="deviceMobile">0</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted);" id="percentMobile">0%</div>
                                    </div>
                                    <div style="background: #f0f7ff; padding: 16px; border-radius: 10px; border-left: 4px solid #00b894;">
                                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;"><i class="fas fa-laptop" style="margin-right: 6px;"></i>Laptop</div>
                                        <div style="font-size: 1.8rem; font-weight: 700; color: var(--text-head);" id="deviceLaptop">0</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted);" id="percentLaptop">0%</div>
                                    </div>
                                    <div style="background: #f0f7ff; padding: 16px; border-radius: 10px; border-left: 4px solid #fdcb6e;">
                                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 8px;"><i class="fas fa-tablet-alt" style="margin-right: 6px;"></i>Tablet</div>
                                        <div style="font-size: 1.8rem; font-weight: 700; color: var(--text-head);" id="deviceTablet">0</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted);" id="percentTablet">0%</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Top Pages -->
                        <div class="card">
                            <div class="card-header"><span class="card-title"><i class="fas fa-file-alt" style="margin-right:8px;"></i>Top Pages Visited</span></div>
                            <div class="card-body">
                                <div id="topPagesContainer" style="display: flex; flex-direction: column; gap: 12px;"></div>
                            </div>
                        </div>

                        <!-- Browser Stats -->
                        <div class="card">
                            <div class="card-header"><span class="card-title"><i class="fas fa-compass" style="margin-right:8px;"></i>Top Browsers</span></div>
                            <div class="card-body">
                                <div id="topBrowsersContainer" style="display: flex; flex-direction: column; gap: 12px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: RECENT CHANGES -->
                    <div id="adm-activity" class="adm-view hidden">
                        <h3 style="margin-bottom: 24px;">Activity Log</h3>
                        
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">Recent Admin Actions</span>
                                <button class="btn btn-secondary btn-sm" style="margin-left: auto;" onclick="clearActivityLog()">Clear Log</button>
                            </div>
                            <div class="card-body">
                                <div id="activityLogContainer" style="display: flex; flex-direction: column; gap: 12px; max-height: 600px; overflow-y: auto;">
                                    <p class="text-muted" style="text-align: center; padding: 40px 20px;">No activity yet. Actions will appear here.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <!-- FIREBASE APP LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, doc, setDoc, getDoc, deleteDoc, updateDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Storage import removed as requested

        // APP CONFIG
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'aarambha-modern';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyBjX8-xYid07zsHw3uMj5Xq3TGx14tCmGA",
            authDomain: "aarambhaitclub-f5716.firebaseapp.com",
            projectId: "aarambhaitclub-f5716",
            storageBucket: "aarambhaitclub-f5716.firebasestorage.app",
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        // --- IMAGE HELPER: RESIZE & COMPRESS FOR FIRESTORE (Base64) ---
        // Firestore docs have a 1MB limit. This ensures images are small enough.
        const resizeImage = (file, maxWidth = 800) => {
            return new Promise((resolve) => {
                if(!file) resolve(null);
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let w = img.width;
                        let h = img.height;
                        
                        // Resize logic
                        if (w > maxWidth) {
                            h *= maxWidth / w;
                            w = maxWidth;
                        }
                        
                        canvas.width = w;
                        canvas.height = h;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, w, h);
                        
                        // Export as compressed JPEG (0.6 quality)
                        resolve(canvas.toDataURL('image/jpeg', 0.6));
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        };

        // --- PATHS ---
        const pCol = (c) => collection(db, 'artifacts', appId, 'public', 'data', c);
        const pDoc = (c, d) => doc(db, 'artifacts', appId, 'public', 'data', c, d);

        // --- GLOBAL STATE ---
        let teamTypes = ['Executive', 'Technical', 'Events', 'Media'];
        let contentCache = [];
        let membersCache = [];
        let joinRequestsCache = [];
        let confirmCallback = null;
        
        // --- ANALYTICS & ACTIVITY TRACKING ---
        let activityLog = JSON.parse(localStorage.getItem('activityLog')) || [];
        let visitorStatsFromStorage = JSON.parse(localStorage.getItem('visitorStats'));
        let visitorStats = {
            today: visitorStatsFromStorage?.today || 0,
            unique: new Set(visitorStatsFromStorage?.unique || []),
            devices: visitorStatsFromStorage?.devices || { mobile: 0, laptop: 0, tablet: 0 },
            browsers: visitorStatsFromStorage?.browsers || {},
            pages: visitorStatsFromStorage?.pages || {},
            liveVisitors: visitorStatsFromStorage?.liveVisitors || 0
        };
        let liveVisitorIds = new Set();
        let lastActivityTime = Date.now();
        
        // Detect device type - More accurate detection
        const detectDevice = () => {
            const ua = navigator.userAgent.toLowerCase();
            // Check for mobile first (before checking android for tablets)
            if (/iphone|ipod|blackberry|iemobile|opera mini/.test(ua)) return 'mobile';
            if (/android/.test(ua)) {
                // If android has tablet indicators, it's a tablet
                if (/tablet|ipad|nexus 7|nexus 10|xoom/.test(ua)) return 'tablet';
                return 'mobile';
            }
            if (/ipad|windows phone|playbook|silk/.test(ua)) return 'tablet';
            // Default to laptop for desktop browsers
            return 'laptop';
        };
        
        // Detect browser
        const detectBrowser = () => {
            const ua = navigator.userAgent;
            if (ua.indexOf('Chrome') > -1 && ua.indexOf('Chromium') === -1) return 'Chrome';
            if (ua.indexOf('Safari') > -1 && ua.indexOf('Chrome') === -1) return 'Safari';
            if (ua.indexOf('Firefox') > -1) return 'Firefox';
            if (ua.indexOf('Edg') > -1) return 'Edge';
            if (ua.indexOf('Opera') > -1 || ua.indexOf('OPR') > -1) return 'Opera';
            return 'Other';
        };
        
        // Track page visit
        const trackPageVisit = () => {
            const page = window.location.hash.replace('#', '') || 'home';
            visitorStats.pages[page] = (visitorStats.pages[page] || 0) + 1;
        };
        
        // Track browser
        const trackBrowser = () => {
            const browser = detectBrowser();
            visitorStats.browsers[browser] = (visitorStats.browsers[browser] || 0) + 1;
        };
        
        // Initialize visitor tracking
        const initVisitorTracking = () => {
            const device = detectDevice();
            visitorStats.devices[device]++;
            visitorStats.today++;
            visitorStats.unique.add(navigator.userAgent + '-' + new Date().toDateString());
            trackBrowser();
            trackPageVisit();
            
            // Add to live visitors
            const visitorId = Date.now() + '-' + Math.random();
            liveVisitorIds.add(visitorId);
            updateLiveVisitors();
            
            // Remove from live visitors after 5 minutes of inactivity
            setTimeout(() => {
                liveVisitorIds.delete(visitorId);
                updateLiveVisitors();
            }, 5 * 60 * 1000);
            
            saveVisitorStats();
            logActivity('Visitor', `New visitor detected (${device})`);
        };
        
        // Update live visitors count
        const updateLiveVisitors = () => {
            visitorStats.liveVisitors = liveVisitorIds.size;
            const el = document.getElementById('liveVisitors');
            if (el) el.innerText = visitorStats.liveVisitors;
            saveVisitorStats();
        };
        
        // Save visitor stats to localStorage
        const saveVisitorStats = () => {
            localStorage.setItem('visitorStats', JSON.stringify({
                ...visitorStats,
                unique: Array.from(visitorStats.unique)
            }));
        };
        
        // Log activity
        const logActivity = (type, message, details = {}) => {
            const log = {
                timestamp: new Date().toLocaleString(),
                type: type,
                message: message,
                details: details
            };
            activityLog.unshift(log);
            
            // Keep only last 100 activities
            if (activityLog.length > 100) activityLog.pop();
            
            localStorage.setItem('activityLog', JSON.stringify(activityLog));
            updateActivityDisplay();
        };
        
        // Update activity display
        const updateActivityDisplay = () => {
            const container = document.getElementById('activityLogContainer');
            if (!container) return;
            
            if (activityLog.length === 0) {
                container.innerHTML = '<p class="text-muted" style="text-align: center; padding: 40px 20px;">No activity yet. Actions will appear here.</p>';
                return;
            }
            
            container.innerHTML = activityLog.map((log, idx) => `
                <div style="background: #f0f7ff; padding: 12px; border-radius: 8px; border-left: 4px solid var(--primary);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <span style="font-weight: 600; color: var(--text-head);">${log.type}</span>
                        <span style="font-size: 0.8rem; color: var(--text-muted);">${log.timestamp}</span>
                    </div>
                    <div style="color: var(--text-body);">${log.message}</div>
                    ${Object.keys(log.details).length > 0 ? `<div style="font-size: 0.85rem; color: var(--text-muted); margin-top: 6px;">${JSON.stringify(log.details)}</div>` : ''}
                </div>
            `).join('');
        };
        
        // Clear activity log
        window.clearActivityLog = () => {
            if (confirm('Are you sure you want to clear the activity log? This cannot be undone.')) {
                activityLog = [];
                localStorage.setItem('activityLog', JSON.stringify(activityLog));
                updateActivityDisplay();
                toast('Activity log cleared');
            }
        };
        
        // Update analytics display
        const updateAnalyticsDisplay = () => {
            // Load stats from localStorage
            const saved = JSON.parse(localStorage.getItem('visitorStats')) || visitorStats;
            const uniqueCount = Array.isArray(saved.unique) ? saved.unique.length : saved.unique.size;
            
            // Update visitor counts
            const totalVisitors = document.getElementById('totalVisitors');
            const uniqueVisitors = document.getElementById('uniqueVisitors');
            const liveVisitors = document.getElementById('liveVisitors');
            
            if (totalVisitors) totalVisitors.innerText = saved.today || 0;
            if (uniqueVisitors) uniqueVisitors.innerText = uniqueCount || 0;
            if (liveVisitors) liveVisitors.innerText = saved.liveVisitors || 0;
            
            // Update device breakdown
            const totalDevices = (saved.devices.mobile || 0) + (saved.devices.laptop || 0) + (saved.devices.tablet || 0);
            
            const mobileEl = document.getElementById('deviceMobile');
            const laptopEl = document.getElementById('deviceLaptop');
            const tabletEl = document.getElementById('deviceTablet');
            const percentMobile = document.getElementById('percentMobile');
            const percentLaptop = document.getElementById('percentLaptop');
            const percentTablet = document.getElementById('percentTablet');
            
            if (mobileEl) mobileEl.innerText = saved.devices.mobile || 0;
            if (laptopEl) laptopEl.innerText = saved.devices.laptop || 0;
            if (tabletEl) tabletEl.innerText = saved.devices.tablet || 0;
            
            if (totalDevices > 0) {
                if (percentMobile) percentMobile.innerText = Math.round((saved.devices.mobile || 0) / totalDevices * 100) + '%';
                if (percentLaptop) percentLaptop.innerText = Math.round((saved.devices.laptop || 0) / totalDevices * 100) + '%';
                if (percentTablet) percentTablet.innerText = Math.round((saved.devices.tablet || 0) / totalDevices * 100) + '%';
            }
            
            // Update top pages
            const topPagesContainer = document.getElementById('topPagesContainer');
            if (topPagesContainer) {
                const pages = Object.entries(saved.pages || {}).sort((a, b) => b[1] - a[1]).slice(0, 5);
                if (pages.length === 0) {
                    topPagesContainer.innerHTML = '<p class="text-muted" style="text-align: center; padding: 20px;">No page data yet</p>';
                } else {
                    topPagesContainer.innerHTML = pages.map(([page, count]) => {
                        const percentage = (count / (saved.today || 1)) * 100;
                        return `
                            <div style="background: #f0f7ff; padding: 12px; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: var(--text-head);">${page || 'Home'}</span>
                                    <span style="color: var(--text-muted);">${count} visits</span>
                                </div>
                                <div style="background: #d9e9f7; height: 6px; border-radius: 3px; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, #0066cc, #00b894); height: 100%; width: ${percentage}%;"></div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }
            
            // Update top browsers
            const topBrowsersContainer = document.getElementById('topBrowsersContainer');
            if (topBrowsersContainer) {
                const browsers = Object.entries(saved.browsers || {}).sort((a, b) => b[1] - a[1]).slice(0, 5);
                if (browsers.length === 0) {
                    topBrowsersContainer.innerHTML = '<p class="text-muted" style="text-align: center; padding: 20px;">No browser data yet</p>';
                } else {
                    topBrowsersContainer.innerHTML = browsers.map(([browser, count]) => {
                        const percentage = (count / (saved.today || 1)) * 100;
                        return `
                            <div style="background: #f0f7ff; padding: 12px; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: var(--text-head);">${browser}</span>
                                    <span style="color: var(--text-muted);">${count} visits</span>
                                </div>
                                <div style="background: #d9e9f7; height: 6px; border-radius: 3px; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, #0066cc, #3399ff); height: 100%; width: ${percentage}%;"></div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }
        };
        
        // Track navigation
        window.addEventListener('hashchange', () => {
            trackPageVisit();
            saveVisitorStats();
            logActivity('Navigation', `User visited ${window.location.hash || 'home'}`);
        });

        // --- UI UTILS ---
        const toast = (msg) => {
            const t = document.createElement('div');
            t.className = 'toast'; t.innerText = msg;
            document.getElementById('toastArea').appendChild(t);
            setTimeout(() => t.remove(), 3000);
        }

        // --- MODAL UTILS ---
        window.showConfirm = (msg, callback) => {
            document.getElementById('confirmMsg').innerText = msg;
            document.getElementById('confirmModal').classList.remove('hidden');
            confirmCallback = callback;
        };

        window.closeConfirm = () => {
            document.getElementById('confirmModal').classList.add('hidden');
            confirmCallback = null;
        };

        document.getElementById('confirmBtnYes').onclick = () => {
            if(confirmCallback) confirmCallback();
            window.closeConfirm();
        };

        // --- NAVIGATION ---
        window.toggleMobileMenu = () => {
            const menu = document.getElementById('navMobile');
            menu.classList.toggle('active');
        };

        window.router = (viewId) => {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            setTimeout(() => document.getElementById(viewId).classList.add('active'), 50);
            
            // Update desktop nav
            document.querySelectorAll('#navDesktop .nav-item').forEach(el => el.classList.remove('active'));
            const btnDesktop = document.getElementById('nav-'+viewId);
            if(btnDesktop) btnDesktop.classList.add('active');
            
            // Update mobile nav
            document.querySelectorAll('#navMobile .nav-item').forEach(el => el.classList.remove('active'));
            const btnMobile = document.getElementById('nav-'+viewId+'-m');
            if(btnMobile) btnMobile.classList.add('active');
            
            window.scrollTo(0,0);
        }

        window.admTab = (tabId, el) => {
            document.querySelectorAll('.adm-view').forEach(e => e.classList.add('hidden'));
            document.getElementById('adm-'+tabId).classList.remove('hidden');
            
            document.querySelectorAll('.sidebar-link').forEach(e => e.classList.remove('active'));
            el.classList.add('active');
            
            // Update analytics display when analytics tab is opened
            if (tabId === 'analytics') {
                updateAnalyticsDisplay();
            }
            
            // Update activity display when activity tab is opened
            if (tabId === 'activity') {
                updateActivityDisplay();
            }
        }

        // --- AUTH & INIT ---
        const init = async () => {
            // Track visitor immediately on init, before any auth
            if (!window.visitorTracked) {
                initVisitorTracking();
                window.visitorTracked = true;
            }
            
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }
            
            onAuthStateChanged(auth, (user) => {
                if(user && !user.isAnonymous) {
                    document.getElementById('adminLogin').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    loadAdminData();
                } else {
                    document.getElementById('adminLogin').classList.remove('hidden');
                    document.getElementById('adminPanel').classList.add('hidden');
                }
                loadPublicData();
            });
        };

        // --- DATA HANDLERS ---
        function loadPublicData() {
            // Initialize visitor tracking for all users (including non-authenticated)
            if (!window.visitorTracked) {
                initVisitorTracking();
                window.visitorTracked = true;
            }
            
            // 1. Settings (Config & Banner)
            onSnapshot(pDoc('settings', 'config'), snap => {
                if(snap.exists()) {
                    const d = snap.data();
                    if(d.teamTypes) teamTypes = d.teamTypes;
                    if(d.logo) document.getElementById('logoImg').src = d.logo;
                    
                    // Banner Logic
                    const b = document.getElementById('siteBanner');
                    if(d.bannerActive && d.bannerText) {
                        b.style.display = 'block';
                        b.innerText = d.bannerText;
                        document.getElementById('bannerText').value = d.bannerText;
                        document.getElementById('bannerActive').checked = true;
                    } else {
                        b.style.display = 'none';
                        document.getElementById('bannerText').value = d.bannerText || '';
                        document.getElementById('bannerActive').checked = false;
                    }
                }
                renderTeamFilters();
                updateSelects();
                renderTeamTypesAdmin(); // Re-render admin list if changed
            }, error => {
                console.warn('Config load error (might be normal if collection doesn\'t exist):', error.code);
            });

            // 1b. Hero Poster Settings
            onSnapshot(pDoc('settings', 'hero'), snap => {
                if(snap.exists()) {
                    const d = snap.data();
                    
                    // Update main hero section
                    if(d.heroTitle) {
                        document.getElementById('heroTitle').innerText = d.heroTitle;
                        document.getElementById('heroPreviewTitle').innerText = d.heroTitle;
                        document.getElementById('heroTitleInput').value = d.heroTitle;
                    }
                    if(d.heroSubtitle) {
                        document.getElementById('heroSubtitle').innerText = d.heroSubtitle;
                        document.getElementById('heroPreviewSubtitle').innerText = d.heroSubtitle;
                        document.getElementById('heroSubtitleInput').value = d.heroSubtitle;
                    }
                    if(d.heroLogo) {
                        document.getElementById('heroLogo').src = d.heroLogo;
                        document.getElementById('heroPreviewLogo').src = d.heroLogo;
                    }
                    if(d.heroBg) {
                        document.getElementById('heroBackground').style.backgroundImage = `url('${d.heroBg}')`;
                        document.getElementById('heroPreviewBg').style.backgroundImage = `url('${d.heroBg}')`;
                    }
                }
            }, error => {
                console.warn('Hero settings load error (might be normal if collection doesn\'t exist):', error.code);
            });

            // 2. Dashboard & Content
            const qDash = query(pCol('dashboard'), orderBy('timestamp', 'desc'));
            onSnapshot(qDash, snap => {
                const t = document.getElementById('homeTargets'); t.innerHTML = '';
                const p = document.getElementById('homePrograms'); p.innerHTML = '';
                const m = document.getElementById('homeMeetings'); m.innerHTML = '';
                const r = document.getElementById('homeRichContent'); r.innerHTML = '';
                
                contentCache = [];

                snap.forEach(d => {
                    const data = d.data(); data.id = d.id; data._col = 'dashboard';
                    contentCache.push(data);

                    const html = `
                        <div class="list-group-item">
                            <div class="list-icon"><i class="fas ${getIcon(data.type)}"></i></div>
                            <div>
                                <div style="font-weight:700; font-size:1rem; color:var(--text-head);">${data.title}</div>
                                <div class="text-muted">${data.content}</div>
                            </div>
                        </div>`;
                    
                    if(data.type.includes('target')) t.innerHTML += html;
                    else if(data.type.includes('program')) p.innerHTML += html;
                    else if(data.type.includes('meeting')) m.innerHTML += html;
                    else {
                        // Achievement-style card with full prominent images
                        const images = data.images || (data.image ? [data.image] : []);
                        const imageCount = images.length;
                        const formattedContent = formatPostContent(data.content);
                        const typeName = data.type.replace('dashboard_', '').replace(/_/g, ' ');
                        
                        // Show all images as full-width gallery
                        const imagesHtml = images.length > 0 
                            ? `<div class="post-images-grid">${images.map((img, idx) => `
                                <div class="post-image-container" onclick="openImageModal('${img}')">
                                    <img src="${img}" class="post-image" alt="Image ${idx + 1}">
                                </div>`).join('')}</div>`
                            : '';
                        
                        r.innerHTML += `
                            <div class="card">
                                <div class="card-header">
                                    <span class="card-title">${data.title}</span>
                                    <span class="achievement-badge">${typeName}</span>
                                </div>
                                <div class="card-body">
                                    ${imagesHtml}
                                    <div class="post-content">
                                        ${formattedContent}
                                        ${imageCount > 0 ? `<div class="photo-count"><i class="fas fa-image"></i> ${imageCount} photo${imageCount > 1 ? 's' : ''}</div>` : ''}
                                    </div>
                                </div>
                            </div>`;
                    }
                });
                renderAdminContent();
            }, error => {
                console.warn('Dashboard load error:', error.code);
                document.getElementById('homeRichContent').innerHTML = '<div style="padding:20px; color:#999; text-align:center;">Unable to load highlights. Check Firestore permissions.</div>';
            });

            // 3. News
            onSnapshot(query(pCol('posts'), orderBy('timestamp', 'desc')), snap => {
                const c = document.getElementById('newsContainer'); c.innerHTML = '';
                snap.forEach(d => {
                    const data = d.data(); data.id = d.id; data._col = 'posts';
                    contentCache.push(data);
                    
                    const formattedContent = formatPostContent(data.content);
                    const images = data.images || (data.image ? [data.image] : []);
                    const imagesHtml = images.length > 0 
                        ? `<div class="post-images-grid">${images.map((img, idx) => `
                            <div class="post-image-container" onclick="openImageModal('${img}')">
                                <img src="${img}" class="post-image" alt="Image ${idx + 1}">
                            </div>`).join('')}</div>`
                        : '';
                    
                    c.innerHTML += `
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">${data.title}</span>
                                <span class="text-muted" style="font-size:0.8rem; font-weight:600;">${new Date(data.timestamp.toDate()).toDateString()}</span>
                            </div>
                            <div class="card-body">
                                ${imagesHtml}
                                ${formattedContent}
                            </div>
                        </div>`;
                });
                renderAdminContent();
            }, error => {
                console.warn('Posts load error:', error.code);
                document.getElementById('newsContainer').innerHTML = '<div style="padding:20px; color:#999; text-align:center;">Unable to load posts. Check Firestore permissions.</div>';
            });

            // 4. Team
            onSnapshot(pCol('members'), snap => {
                membersCache = [];
                snap.forEach(d => membersCache.push({id: d.id, ...d.data()}));
                // Sort by order field for consistent display
                membersCache.sort((a, b) => (a.order || 0) - (b.order || 0));
                document.getElementById('statMem').innerText = membersCache.length;
                renderTeam('all');
                renderAdminMembers();
            }, error => {
                console.warn('Members load error:', error.code);
            });

            // 5. Social Media Links
            onSnapshot(pDoc('settings', 'socialmedia'), snap => {
                if(snap.exists()) {
                    const data = snap.data();
                    renderSocialMedia(data.links || []);
                    renderAdminSocialMedia(data.links || []);
                } else {
                    renderSocialMedia([]);
                    renderAdminSocialMedia([]);
                }
            }, error => {
                console.warn('Social media load error:', error.code);
            });
        }

        // --- RENDERERS ---
        function getIcon(t) {
            if(t.includes('target')) return 'fa-bullseye';
            if(t.includes('program')) return 'fa-calendar';
            return 'fa-clock';
        }

        function renderTeamFilters() {
            const d = document.getElementById('teamFilters');
            d.innerHTML = `<button class="filter-btn active" onclick="filterTeam('all', this)">All</button>`;
            teamTypes.forEach(t => d.innerHTML += `<button class="filter-btn" onclick="filterTeam('${t}', this)">${t}</button>`);
        }

        function updateSelects() {
            const opts = teamTypes.map(t => `<option value="${t}">${t}</option>`).join('');
            document.getElementById('joinTeam').innerHTML = opts;
            document.getElementById('memTeam').innerHTML = opts;
        }

        window.filterTeam = (cat, btn) => {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTeam(cat);
        }

        function renderTeam(cat) {
            const g = document.getElementById('teamGrid'); g.innerHTML = '';
            let list = membersCache;
            
            // Team hierarchy order (Core team is always first)
            const teamOrder = { 'Core': 0, 'Technical': 1, 'Design': 2, 'Marketing': 3, 'Operations': 4 };
            
            if(cat !== 'all') {
                list = list.filter(m => m.team === cat);
            } else {
                // Sort by team hierarchy first, then process
                list.sort((a, b) => {
                    const teamOrderA = teamOrder[a.team] ?? 999;
                    const teamOrderB = teamOrder[b.team] ?? 999;
                    return teamOrderA - teamOrderB;
                });
            }
            
            // Sort by admin-defined order first, then leaders first within same order
            list.sort((a, b) => {
                const orderA = a.order || 0;
                const orderB = b.order || 0;
                if (orderA !== orderB) return orderA - orderB;
                return (b.isLeader || 0) - (a.isLeader || 0);
            });
            
            if(list.length === 0) g.innerHTML = '<p class="text-muted" style="grid-column:1/-1; text-align:center;">No members found.</p>';

            list.forEach(m => {
                g.innerHTML += `
                    <div class="member-card ${m.isLeader ? 'leader' : ''}">
                        <div class="member-img-container">
                            ${m.isLeader ? '<div class="member-badge"><i class="fas fa-star"></i></div>' : ''}
                            <img src="${m.photo || 'https://via.placeholder.com/200?text=Member'}" class="member-img" data-member-id="${m.id}">
                        </div>
                        <div class="member-info">
                            <div class="member-role">${m.team}</div>
                            <div class="member-name">${m.name}</div>
                            <div class="member-position">${m.role}</div>
                        </div>
                    </div>`;
            });
            
            // Adjust image positioning for better face visibility
            setTimeout(() => optimizeImagePositioning(), 200);
        }

        // --- SMART IMAGE POSITIONING ---
        function optimizeImagePositioning() {
            const memberImages = document.querySelectorAll('.member-img');
            
            memberImages.forEach(img => {
                // Only adjust if not already processed
                if(!img.dataset.positionCalculated) {
                    img.addEventListener('load', () => {
                        adjustImagePosition(img);
                    });
                    
                    // If already loaded, adjust immediately
                    if(img.complete && img.naturalHeight > 0) {
                        adjustImagePosition(img);
                    }
                }
            });
        }

        function adjustImagePosition(img) {
            // Skip if already calculated
            if(img.dataset.positionCalculated === 'true') return;
            
            try {
                const canvas = document.createElement('canvas');
                canvas.width = img.naturalWidth;
                canvas.height = img.naturalHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                let topY = canvas.height;
                let bottomY = 0;
                let hasContent = false;
                
                // Find the vertical bounds of non-transparent/non-white content
                for(let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    const a = data[i + 3];
                    
                    // Skip white or very light pixels and transparent pixels
                    if(a > 128 && !(r > 240 && g > 240 && b > 240)) {
                        hasContent = true;
                        const pixelIndex = i / 4;
                        const y = Math.floor(pixelIndex / canvas.width);
                        
                        if(y < topY) topY = y;
                        if(y > bottomY) bottomY = y;
                    }
                }
                
                let finalPosition = 'center 35%';
                
                if(hasContent && bottomY > topY) {
                    const contentCenter = (topY + bottomY) / 2;
                    const positionPercent = (contentCenter / canvas.height) * 100;
                    
                    // Clamp between 25% and 75% for natural framing
                    const clampedPosition = Math.max(25, Math.min(75, positionPercent));
                    finalPosition = `center ${clampedPosition}%`;
                }
                
                // Apply position and mark as calculated
                img.style.objectPosition = finalPosition;
                img.dataset.positionCalculated = 'true';
            } catch(e) {
                // Fallback to default positioning
                img.style.objectPosition = 'center 35%';
                img.dataset.positionCalculated = 'true';
            }
        }

        // --- SOCIAL MEDIA RENDERING ---
        function renderSocialMedia(links) {
            const display = document.getElementById('socialMediaDisplay');
            const noMsg = document.getElementById('noSocialDisplay');
            
            if(!links || links.length === 0) {
                display.innerHTML = '';
                noMsg.style.display = 'block';
                return;
            }
            
            noMsg.style.display = 'none';
            display.innerHTML = '';
            
            const platformIcons = {
                'Facebook': 'fab fa-facebook',
                'Twitter': 'fab fa-twitter',
                'Instagram': 'fab fa-instagram',
                'LinkedIn': 'fab fa-linkedin',
                'YouTube': 'fab fa-youtube',
                'Discord': 'fab fa-discord',
                'GitHub': 'fab fa-github',
                'Telegram': 'fab fa-telegram',
                'TikTok': 'fab fa-tiktok'
            };

            links.forEach(link => {
                const icon = platformIcons[link.platform] || 'fas fa-link';
                display.innerHTML += `
                    <a href="${link.url}" target="_blank" rel="noopener noreferrer" style="display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 20px; text-decoration: none; color: var(--text-body); transition: var(--trans); border-radius: 12px; border: 1px solid #e2e8f0; cursor: pointer; min-width: 120px; text-align: center;">
                        <i class="${icon}" style="font-size: 2.5rem; color: var(--primary);"></i>
                        <span style="font-weight: 600; font-size: 0.9rem;">${link.platform}</span>
                    </a>`;
            });
        }

        function renderAdminSocialMedia(links) {
            const list = document.getElementById('socialMediaList');
            const noMsg = document.getElementById('noSocialMsg');
            
            if(!links || links.length === 0) {
                list.innerHTML = '';
                noMsg.style.display = 'block';
                return;
            }
            
            noMsg.style.display = 'none';
            list.innerHTML = '';
            
            links.forEach((link, idx) => {
                list.innerHTML += `
                    <div style="display: flex; justify-content: space-between; align-items: center; background: white; padding: 12px 16px; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <i class="fab fa-${link.platform.toLowerCase()}" style="font-size: 1.5rem; color: var(--primary); min-width: 24px;"></i>
                            <div>
                                <div style="font-weight: 600; color: var(--text-head);">${link.platform}</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted); word-break: break-all;">${link.url}</div>
                            </div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="deleteSocialMedia(${idx})"><i class="fas fa-trash"></i></button>
                    </div>`;
            });
        }

        // --- PUBLIC ACTIONS ---
        document.getElementById('btnJoinSubmit').onclick = async () => {
            const btn = document.getElementById('btnJoinSubmit');
            btn.innerText = "Submitting...";
            const data = {
                name: document.getElementById('joinName').value,
                sem: document.getElementById('joinSem').value,
                dept: document.getElementById('joinDept').value,
                team: document.getElementById('joinTeam').value,
                reason: document.getElementById('joinReason').value,
                timestamp: new Date()
            };
            if(!data.name) { toast('Name required'); btn.innerText = "Submit Application"; return; }
            try { await addDoc(pCol('join_requests'), data); toast('Application Submitted'); document.getElementById('joinName').value=''; }
            catch(e) { console.error(e); }
            btn.innerText = "Submit Application";
        };

        document.getElementById('btnSubmitIdea').onclick = async () => {
            const txt = document.getElementById('ideaText').value;
            if(!txt) return;
            await addDoc(pCol('ideas'), { suggestion: txt, timestamp: new Date() });
            toast('Idea Submitted');
            document.getElementById('ideaText').value = '';
        };

        // --- ADMIN ACTIONS ---
        function loadAdminData() {
            logActivity('Admin', 'Admin logged in and accessed dashboard');
            
            // Requests
            onSnapshot(query(pCol('join_requests'), orderBy('timestamp', 'desc')), snap => {
                joinRequestsCache = [];
                snap.forEach(d => joinRequestsCache.push({id: d.id, ...d.data()}));
                
                document.getElementById('statReq').innerText = snap.size;
                const b = document.getElementById('badgeInbox');
                if(snap.size > 0) { b.innerText = snap.size; b.classList.remove('hidden'); }
                else b.classList.add('hidden');

                const t = document.querySelector('#tblRequests tbody'); t.innerHTML = '';
                joinRequestsCache.forEach(r => {
                    t.innerHTML += `
                        <tr>
                            <td><strong>${r.name}</strong></td><td>${r.dept}</td><td>${r.team}</td>
                            <td>
                                <button class="btn btn-success btn-sm" onclick="acceptJoinRequest('${r.id}', '${r.name}', '${r.dept}', '${r.team}')" title="Accept"><i class="fas fa-check"></i> Accept</button>
                                <button class="btn btn-danger btn-sm" onclick="delItem('join_requests','${r.id}')" title="Reject"><i class="fas fa-trash"></i></button>
                            </td>
                        </tr>`;
                });
            }, error => {
                console.warn('Join requests load error:', error.code);
            });

            // Ideas
            onSnapshot(query(pCol('ideas'), orderBy('timestamp', 'desc')), snap => {
                document.getElementById('statIdea').innerText = snap.size;
                const t = document.querySelector('#tblIdeas tbody'); t.innerHTML = '';
                snap.forEach(d => {
                    const i = d.data();
                    t.innerHTML += `<tr><td>${i.suggestion}</td><td>${new Date(i.timestamp.toDate()).toLocaleDateString()}</td><td><button class="btn btn-danger btn-sm" onclick="delItem('ideas','${d.id}')"><i class="fas fa-trash"></i></button></td></tr>`;
                });
            }, error => {
                console.warn('Ideas load error:', error.code);
            });
        }

        // --- ACCEPT JOIN REQUEST ---
        window.acceptJoinRequest = async (requestId, name, dept, team) => {
            try {
                // Create new member from join request
                const memberData = {
                    name: name,
                    dept: dept,
                    team: team,
                    role: dept, // Use department as initial role
                    isLeader: false,
                    timestamp: new Date()
                };

                // Add to members collection
                await addDoc(pCol('members'), memberData);

                // Delete from join_requests
                await deleteDoc(pDoc('join_requests', requestId));

                toast(`${name} has been added to the team!`);
            } catch(e) {
                console.error(e);
                toast('Error accepting request');
            }
        };

        // --- MEMBER MANAGEMENT (Edit/Add) ---
        
        window.openMemberForm = (id = null) => {
            const form = document.getElementById('formAddMem');
            const title = document.getElementById('formMemTitle');
            form.classList.remove('hidden');
            
            if(id) {
                // Edit Mode
                const m = membersCache.find(x => x.id === id);
                if(!m) return;
                title.innerText = "Edit Member";
                document.getElementById('memIdEdit').value = id;
                document.getElementById('memName').value = m.name;
                document.getElementById('memRole').value = m.role;
                document.getElementById('memTeam').value = m.team;
                document.getElementById('memLeader').checked = m.isLeader;
            } else {
                // Add Mode
                title.innerText = "Add New Member";
                document.getElementById('memIdEdit').value = '';
                document.getElementById('memName').value = '';
                document.getElementById('memRole').value = '';
                document.getElementById('memLeader').checked = false;
            }
        };

        document.getElementById('btnAddMem').onclick = async () => {
            const btn = document.getElementById('btnAddMem');
            btn.innerText = "Saving...";
            
            const id = document.getElementById('memIdEdit').value;
            const name = document.getElementById('memName').value;
            const role = document.getElementById('memRole').value;
            const team = document.getElementById('memTeam').value;
            const isLeader = document.getElementById('memLeader').checked;
            const file = document.getElementById('memPhoto').files[0];

            if(!name) { toast('Name required'); btn.innerText = "Save Member"; return; }
            
            const data = { name, role, team, isLeader, timestamp: new Date() };

            if(file) {
                // Store resized image directly in Firestore
                data.photo = await resizeImage(file);
            }

            try {
                if(id) {
                    await setDoc(pDoc('members', id), data, { merge: true });
                    toast('Member Updated');
                } else {
                    await addDoc(pCol('members'), data);
                    toast('Member Added');
                }
                document.getElementById('formAddMem').classList.add('hidden');
            } catch(e) { console.error(e); toast('Error saving'); }
            
            btn.innerText = "Save Member";
        };

        // Render Members Admin with Edit/Delete
        function renderAdminMembers() {
            const t = document.querySelector('#tblMembers tbody'); t.innerHTML = '';
            
            // Sort by order field if available
            const sortedMembers = [...membersCache].sort((a, b) => (a.order || 0) - (b.order || 0));
            
            sortedMembers.forEach((m, index) => {
                const row = document.createElement('tr');
                row.className = 'member-row-draggable';
                row.draggable = true;
                row.dataset.id = m.id;
                row.dataset.index = index;
                
                row.innerHTML = `
                    <td><span class="member-row-drag-handle" title="Drag to reorder"><i class="fas fa-grip-vertical"></i></span> <strong>${m.name}</strong></td>
                    <td>${m.role}</td>
                    <td><span style="background:#eff6ff; color:#2563eb; padding:2px 8px; border-radius:10px; font-size:0.8rem; font-weight:700;">${m.team}</span></td>
                    <td>${m.isLeader?'<i class="fas fa-check"></i>':'-'}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="openMemberForm('${m.id}')" title="Edit"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-danger btn-sm" onclick="delItem('members','${m.id}')" title="Delete"><i class="fas fa-trash"></i></button>
                    </td>`;
                
                // Add drag event listeners
                row.addEventListener('dragstart', handleMemberDragStart);
                row.addEventListener('dragover', handleMemberDragOver);
                row.addEventListener('drop', handleMemberDrop);
                row.addEventListener('dragend', handleMemberDragEnd);
                row.addEventListener('dragenter', e => e.preventDefault());
                row.addEventListener('dragleave', handleMemberDragLeave);
                
                t.appendChild(row);
            });
        }

        // --- SETTINGS: DRAG & DROP TEAM TYPES ---
        
        function renderTeamTypesAdmin() {
            const container = document.getElementById('listTeamTypes'); 
            container.innerHTML = '';
            
            teamTypes.forEach((t, index) => {
                const div = document.createElement('div');
                div.className = 'team-tag-draggable';
                div.draggable = true;
                div.dataset.index = index;
                div.innerHTML = `<span>${t}</span> <i class="fas fa-times tag-del-btn" onclick="deleteTeamType(${index})"></i>`;
                
                // Drag Events
                div.addEventListener('dragstart', handleDragStart);
                div.addEventListener('dragover', handleDragOver);
                div.addEventListener('drop', handleDrop);
                div.addEventListener('dragenter', e => e.preventDefault());
                div.addEventListener('dragleave', e => e.target.closest('.team-tag-draggable')?.classList.remove('dragging')); // Simple visual fix
                
                container.appendChild(div);
            });
        }

        let dragSrcEl = null;

        function handleDragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
            this.classList.add('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        async function handleDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            const target = e.target.closest('.team-tag-draggable');
            
            if (dragSrcEl !== target && target) {
                const oldIdx = parseInt(dragSrcEl.dataset.index);
                const newIdx = parseInt(target.dataset.index);
                
                // Swap in array
                const item = teamTypes.splice(oldIdx, 1)[0];
                teamTypes.splice(newIdx, 0, item);
                
                // Update DB
                await setDoc(pDoc('settings', 'config'), { teamTypes }, { merge: true });
                renderTeamTypesAdmin(); // Re-render
            }
            dragSrcEl.classList.remove('dragging');
            return false;
        }

        window.deleteTeamType = (index) => {
            showConfirm(`Delete team "${teamTypes[index]}"? Members in this team will remain but may need updating.`, async () => {
                teamTypes.splice(index, 1);
                await setDoc(pDoc('settings', 'config'), { teamTypes }, { merge: true });
                toast('Team Deleted');
            });
        };

        document.getElementById('btnAddTeamType').onclick = async () => {
            const val = document.getElementById('newTeamType').value;
            if(!val) return;
            if(teamTypes.includes(val)) { toast('Team exists'); return; }
            teamTypes.push(val);
            await setDoc(pDoc('settings', 'config'), { teamTypes }, { merge: true });
            document.getElementById('newTeamType').value = '';
        };

        // --- MEMBER DRAG & DROP REORDERING ---
        let dragSrcMemberEl = null;
        let dragOverRow = null;

        function handleMemberDragStart(e) {
            dragSrcMemberEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', this.dataset.id);
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function handleMemberDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            const targetRow = e.target.closest('tr.member-row-draggable');
            if (targetRow && targetRow !== dragSrcMemberEl) {
                if (dragOverRow && dragOverRow !== targetRow) {
                    dragOverRow.classList.remove('drag-over');
                }
                dragOverRow = targetRow;
                targetRow.classList.add('drag-over');
            }
            return false;
        }

        function handleMemberDragLeave(e) {
            const targetRow = e.target.closest('tr.member-row-draggable');
            if (targetRow === dragOverRow) {
                dragOverRow.classList.remove('drag-over');
                dragOverRow = null;
            }
        }

        async function handleMemberDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (e.preventDefault) e.preventDefault();
            
            if (dragOverRow) {
                dragOverRow.classList.remove('drag-over');
            }
            
            const targetRow = e.target.closest('tr.member-row-draggable');
            if (!targetRow || dragSrcMemberEl === targetRow) return false;
            
            const srcId = dragSrcMemberEl.dataset.id;
            const tgtId = targetRow.dataset.id;
            
            const srcMember = membersCache.find(m => m.id === srcId);
            const tgtMember = membersCache.find(m => m.id === tgtId);
            
            if (srcMember && tgtMember) {
                try {
                    // Re-index all members based on their position in the sorted array
                    const sortedMembers = [...membersCache].sort((a, b) => (a.order || 0) - (b.order || 0));
                    const srcIdx = sortedMembers.findIndex(m => m.id === srcId);
                    const tgtIdx = sortedMembers.findIndex(m => m.id === tgtId);
                    
                    if (srcIdx === -1 || tgtIdx === -1) return false;
                    
                    // Re-order: remove src and insert at target position
                    const reordered = [...sortedMembers];
                    reordered.splice(srcIdx, 1);
                    reordered.splice(tgtIdx, 0, srcMember);
                    
                    // Update order field for each member sequentially
                    for (let i = 0; i < reordered.length; i++) {
                        const member = reordered[i];
                        member.order = i;
                        await updateDoc(pDoc('members', member.id), { order: i });
                    }
                    
                    toast('Members reordered');
                    // Re-sort cache and re-render
                    membersCache.sort((a, b) => (a.order || 0) - (b.order || 0));
                    renderAdminMembers();
                } catch(err) {
                    console.error('Error reordering:', err);
                    toast('Error reordering members');
                }
            }
            
            return false;
        }

        function handleMemberDragEnd(e) {
            this.classList.remove('dragging');
            if (dragOverRow) {
                dragOverRow.classList.remove('drag-over');
                dragOverRow = null;
            }
            dragSrcMemberEl = null;
            document.querySelectorAll('tr.member-row-draggable').forEach(row => row.classList.remove('drag-over'));
        }

        // --- BANNER SETTINGS ---
        document.getElementById('btnSaveBanner').onclick = async () => {
             const text = document.getElementById('bannerText').value;
             const active = document.getElementById('bannerActive').checked;
             await setDoc(pDoc('settings', 'config'), { bannerText: text, bannerActive: active }, { merge: true });
             toast('Banner Settings Saved');
        };

        // --- SOCIAL MEDIA LINKS ---
        document.getElementById('btnAddSocialMedia').onclick = async () => {
            const platform = document.getElementById('socialPlatform').value;
            const url = document.getElementById('socialUrl').value;
            
            if(!platform || !url) {
                toast('Please enter platform and URL');
                return;
            }

            if(!url.startsWith('http://') && !url.startsWith('https://')) {
                toast('URL must start with http:// or https://');
                return;
            }

            try {
                // Get existing links
                const snap = await getDoc(pDoc('settings', 'socialmedia'));
                let links = snap.exists() ? (snap.data().links || []) : [];
                
                // Check if platform already exists and update, else add new
                const existingIdx = links.findIndex(l => l.platform === platform);
                if(existingIdx >= 0) {
                    links[existingIdx].url = url;
                } else {
                    links.push({ platform, url });
                }
                
                await setDoc(pDoc('settings', 'socialmedia'), { links }, { merge: true });
                toast('Social Media Link Added/Updated');
                document.getElementById('socialUrl').value = '';
            } catch(e) {
                console.error(e);
                toast('Error saving link');
            }
        };

        window.deleteSocialMedia = async (idx) => {
            showConfirm('Delete this social media link?', async () => {
                try {
                    const snap = await getDoc(pDoc('settings', 'socialmedia'));
                    if(snap.exists()) {
                        let links = snap.data().links || [];
                        links.splice(idx, 1);
                        await setDoc(pDoc('settings', 'socialmedia'), { links }, { merge: true });
                        toast('Link Deleted');
                    }
                } catch(e) {
                    console.error(e);
                    toast('Error deleting link');
                }
            });
        };
        
        // --- BRANDING ---
        document.getElementById('btnUpdateLogo').onclick = async () => {
            const file = document.getElementById('logoUpload').files[0];
            if(!file) return;
            
            const base64 = await resizeImage(file);
            await setDoc(pDoc('settings', 'config'), { logo: base64 }, { merge: true });
            toast('Logo Updated');
        };

        // --- HERO POSTER MANAGER ---
        document.getElementById('btnSaveHero').onclick = async () => {
            const btn = document.getElementById('btnSaveHero');
            btn.innerText = 'Saving...';
            
            const heroTitle = document.getElementById('heroTitleInput').value || 'Aarambha IT Club';
            const heroSubtitle = document.getElementById('heroSubtitleInput').value || 'Innovate. Create. Lead.';
            const logoFile = document.getElementById('heroLogoUpload').files[0];
            const bgFile = document.getElementById('heroBgUpload').files[0];

            const data = { heroTitle, heroSubtitle };

            if(logoFile) {
                data.heroLogo = await resizeImage(logoFile, 300);
            }
            if(bgFile) {
                data.heroBg = await resizeImage(bgFile, 1200);
            }

            try {
                await setDoc(pDoc('settings', 'hero'), data, { merge: true });
                toast('Hero Poster Saved');
            } catch(e) {
                console.error(e);
                toast('Error saving hero poster');
            }
            btn.innerText = 'Save Hero Poster';
        };

        // Real-time preview updates
        document.getElementById('heroTitleInput').addEventListener('input', (e) => {
            document.getElementById('heroPreviewTitle').innerText = e.target.value || 'Aarambha IT Club';
        });

        document.getElementById('heroSubtitleInput').addEventListener('input', (e) => {
            document.getElementById('heroPreviewSubtitle').innerText = e.target.value || 'Innovate. Create. Lead.';
        });

        document.getElementById('heroLogoUpload').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    document.getElementById('heroPreviewLogo').src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('heroBgUpload').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    document.getElementById('heroPreviewBg').style.backgroundImage = `url('${event.target.result}')`;
                };
                reader.readAsDataURL(file);
            }
        });

        // --- EXPORT CSV ---
        window.exportData = (type, filename) => {
            let data = [];
            if(type === 'members') data = membersCache;
            else if(type === 'join_requests') data = joinRequestsCache;
            
            if(!data.length) { toast('No data to export'); return; }

            const headers = Object.keys(data[0]).join(',');
            const rows = data.map(obj => Object.values(obj).map(v => 
                typeof v === 'string' ? `"${v.replace(/"/g, '""')}"` : v
            ).join(','));
            
            const csvContent = "data:text/csv;charset=utf-8," + [headers, ...rows].join('\n');
            const link = document.createElement("a");
            link.setAttribute("href", encodeURI(csvContent));
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        // Format text content into proper paragraphs and links
        function formatPostContent(text) {
            // Convert markdown-like syntax to HTML
            // Bold: **text** -> <strong>text</strong>
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // Italic: _text_ -> <em>text</em>
            text = text.replace(/_([^_]+)_/g, '<em>$1</em>');
            
            // Links: [text](url) -> <a href="url" target="_blank">text</a>
            // Supports both http/https URLs and relative URLs
            text = text.replace(/\[(.*?)\]\(([^\s)]+)\)/g, (match, linkText, url) => {
                // Ensure proper URL format
                let fullUrl = url;
                if (!url.startsWith('http://') && !url.startsWith('https://') && !url.startsWith('/')) {
                    fullUrl = 'https://' + url;
                }
                return `<a href="${fullUrl}" target="_blank" rel="noopener noreferrer">${linkText}</a>`;
            });
            
            // Separate paragraphs (double line breaks)
            const paragraphs = text.split('\n\n');
            const formattedParagraphs = paragraphs
                .map(para => {
                    const trimmed = para.trim();
                    return trimmed ? `<p>${trimmed}</p>` : '';
                })
                .filter(p => p)
                .join('');
            
            return `<div class="post-content">${formattedParagraphs}</div>`;
        }

        // Insert formatting helpers
        window.insertTextFormat = (format) => {
            const textarea = document.getElementById('pubContent');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selected = textarea.value.substring(start, end) || 'text';
            const before = textarea.value.substring(0, start);
            const after = textarea.value.substring(end);
            
            if (format === '\n\n') {
                textarea.value = before + format + after;
            } else {
                textarea.value = before + format + selected + format + after;
            }
            textarea.focus();
        };

        window.insertLink = () => {
            const url = prompt('Enter the URL:', 'https://');
            const text = prompt('Enter link text:', 'Click here');
            if (url && text) {
                insertTextFormat('');
                const textarea = document.getElementById('pubContent');
                const start = textarea.selectionStart;
                textarea.value = textarea.value.substring(0, start) + `[${text}](${url})` + textarea.value.substring(start);
                textarea.focus();
            }
        };

        // Image Modal Functions
        window.openImageModal = (imageSrc) => {
            const modal = document.createElement('div');
            modal.className = 'image-modal-overlay';
            modal.innerHTML = `
                <div class="image-modal-content">
                    <button class="image-modal-close" onclick="this.closest('.image-modal-overlay').remove()">&times;</button>
                    <img src="${imageSrc}" class="image-modal-img" alt="Full size image">
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        };

        // Image preview handler for multiple files
        document.getElementById('pubImg').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            const preview = document.getElementById('imgPreview');
            preview.innerHTML = '';
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                reader.onload = (event) => {
                    const div = document.createElement('div');
                    div.className = 'file-preview-item';
                    div.innerHTML = `
                        <img src="${event.target.result}" alt="Preview ${i}">
                        <button class="file-preview-remove" type="button" onclick="removeImagePreview(this, ${i})">&times;</button>
                    `;
                    preview.appendChild(div);
                };
                reader.readAsDataURL(file);
            }
        });

        window.removeImagePreview = (btn, index) => {
            btn.closest('.file-preview-item').remove();
        };

        // Publish Content
        document.getElementById('btnPub').onclick = async () => {
            const btn = document.getElementById('btnPub');
            btn.innerText = "Publishing...";
            const type = document.getElementById('pubType').value;
            const title = document.getElementById('pubTitle').value;
            const content = document.getElementById('pubContent').value;
            const fileInputs = document.getElementById('pubImg').files;

            if (!title || !content) {
                toast('Please fill in title and content');
                btn.innerText = "Publish Now";
                return;
            }

            let images = [];
            if(fileInputs && fileInputs.length > 0) {
                // Store resized images directly in Firestore
                for (let i = 0; i < fileInputs.length; i++) {
                    const resized = await resizeImage(fileInputs[i], 800);
                    if (resized) images.push(resized);
                }
            }

            const colName = type === 'posts' ? 'posts' : 'dashboard';
            await addDoc(pCol(colName), { 
                type, 
                title, 
                content, 
                images: images,
                timestamp: new Date() 
            });
            toast('Published Successfully!');
            
            // Clear form
            document.getElementById('pubTitle').value = '';
            document.getElementById('pubContent').value = '';
            document.getElementById('pubImg').value = '';
            document.getElementById('imgPreview').innerHTML = '';
            
            btn.innerText = "Publish Now";
        };

        function renderAdminContent() {
            const l = document.getElementById('listContent'); l.innerHTML = '';
            contentCache.sort((a,b) => b.timestamp - a.timestamp);
            contentCache.forEach(c => {
                const imageCount = (c.images && c.images.length) ? c.images.length : (c.image ? 1 : 0);
                l.innerHTML += `
                    <div style="display:flex; justify-content:space-between; border-bottom:1px solid #f1f5f9; padding:16px; align-items:center; gap:12px;">
                        <div style="flex:1;">
                            <div style="font-weight:600; margin-bottom:4px;">${c.title}</div>
                            <div style="font-size:0.8rem; color:#64748b; margin-bottom:6px;">${c.type}</div>
                            <div style="font-size:0.75rem; color:#94a3b8;">
                                 ${imageCount} image(s) | Published: ${new Date(c.timestamp.toDate()).toLocaleDateString()}
                            </div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="delItem('${c._col}','${c.id}')"><i class="fas fa-trash"></i></button>
                    </div>`;
            });
        }

        // GLOBAL UTILS
        window.delItem = (col, id) => {
            showConfirm('Are you sure you want to delete this item? This cannot be undone.', async () => {
                await deleteDoc(pDoc(col, id));
                toast('Deleted Successfully');
            });
        };

        // AUTH
        document.getElementById('btnLogin').onclick = async () => {
            try {
                const email = document.getElementById('admEmail').value;
                await signInWithEmailAndPassword(auth, email, document.getElementById('admPass').value);
                toast('Logged In');
                logActivity('Login', `Admin user logged in: ${email}`);
            } catch(e) { 
                alert(e.message);
                logActivity('Login Failed', `Failed login attempt`, {error: e.message});
            }
        };
        document.getElementById('btnLogout').onclick = () => {
            logActivity('Logout', 'Admin user logged out');
            signOut(auth);
        };

        init();
    </script>

    <!-- FOOTER -->
    <footer style="background: linear-gradient(180deg, rgba(0, 102, 204, 0.05) 0%, rgba(0, 102, 204, 0.08) 100%); color: #1a3a52; text-align: center; padding: 32px 20px; margin-top: 60px; border-top: 2px solid rgba(0, 102, 204, 0.1); backdrop-filter: blur(10px);">
        <div style="max-width: 1200px; margin: 0 auto;">
            <p style="margin: 0 0 12px 0; font-size: 13px; letter-spacing: 0.5px; font-weight: 500;">
                &copy; 2025 <span style="color: #0066cc; font-weight: 700;">Aarambha IT Club</span>. All rights reserved.
            </p>
            <p style="margin: 0; font-size: 12px; color: #5a7a8a;">
                Designed & Developed by <span style="color: #0066cc; font-weight: 600;">Ajaya Dhungana</span>
            </p>
        </div>
    </footer>
</body>
</html>
